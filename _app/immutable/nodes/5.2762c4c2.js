import{S as ie,i as se,s as re,M as ae,k as P,a as F,l as C,m as M,c as B,h as v,X as ge,n as T,b as E,G as I,a2 as Et,I as U,g as A,v as Q,d as O,f as $,Y as qe,K as Ae,Z as je,a3 as Tn,j as ni,N as be,Q as ft,R as dt,T as ht,U as mt,a1 as ye,P as Z,a4 as ii,a5 as Pe,a6 as We,D as si,o as Ke,a7 as ri,y as q,z as W,A as K,B as J,q as j,r as x,u as X,a8 as It,J as G,e as Y,a9 as li,C as ai,F as oi,aa as St,w as xe,$ as Re,ab as wn,a0 as ze,H as En,E as In}from"../chunks/index.897971b5.js";import{P as Sn,I as An}from"../chunks/InjectMD.323158ff.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.84e8538a.js";import{b as pt}from"../chunks/paths.f36a024d.js";const ui=i=>({}),At=i=>({});function Pt(i,e,t){const n=i.slice();return n[23]=e[t],n}function Ct(i){let e,t;const n=i[15].default,s=ft(n,i,i[14],null);return{c(){e=P("label"),s&&s.c(),this.h()},l(r){e=C(r,"LABEL",{class:!0,for:!0});var l=M(e);s&&s.l(l),l.forEach(v),this.h()},h(){T(e,"class","range-slider-label "+di),T(e,"for",i[2])},m(r,l){E(r,e,l),s&&s.m(e,null),t=!0},p(r,l){s&&s.p&&(!t||l&16384)&&dt(s,n,r,r[14],t?mt(n,r[14],l,null):ht(r[14]),null),(!t||l&4)&&T(e,"for",r[2])},i(r){t||(A(s,r),t=!0)},o(r){O(s,r),t=!1},d(r){r&&v(e),s&&s.d(r)}}}function Nt(i){let e,t,n=i[8],s=[];for(let r=0;r<n.length;r+=1)s[r]=Mt(Pt(i,n,r));return{c(){e=P("datalist");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=C(r,"DATALIST",{id:!0,class:!0});var l=M(e);for(let a=0;a<s.length;a+=1)s[a].l(l);l.forEach(v),this.h()},h(){T(e,"id",t="tickmarks-"+i[2]),T(e,"class","range-slider-ticks")},m(r,l){E(r,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(r,l){if(l&256){n=r[8];let a;for(a=0;a<n.length;a+=1){const o=Pt(r,n,a);s[a]?s[a].p(o,l):(s[a]=Mt(o),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=n.length}l&4&&t!==(t="tickmarks-"+r[2])&&T(e,"id",t)},d(r){r&&v(e),ye(s,r)}}}function Mt(i){let e,t,n;return{c(){e=P("option"),this.h()},l(s){e=C(s,"OPTION",{label:!0}),M(e).forEach(v),this.h()},h(){e.__value=t=i[23],e.value=e.__value,T(e,"label",n=i[23])},m(s,r){E(s,e,r)},p(s,r){r&256&&t!==(t=s[23])&&(e.__value=t,e.value=e.__value),r&256&&n!==(n=s[23])&&T(e,"label",n)},d(s){s&&v(e)}}}function Ot(i){let e,t;const n=i[15].trail,s=ft(n,i,i[14],At);return{c(){e=P("div"),s&&s.c(),this.h()},l(r){e=C(r,"DIV",{class:!0});var l=M(e);s&&s.l(l),l.forEach(v),this.h()},h(){T(e,"class","range-slider-trail")},m(r,l){E(r,e,l),s&&s.m(e,null),t=!0},p(r,l){s&&s.p&&(!t||l&16384)&&dt(s,n,r,r[14],t?mt(n,r[14],l,ui):ht(r[14]),At)},i(r){t||(A(s,r),t=!0)},o(r){O(s,r),t=!1},d(r){r&&v(e),s&&s.d(r)}}}function ci(i){let e,t,n,s,r,l,a,o,u,p,f,d,c=i[12].default&&Ct(i),m=[{type:"range"},{id:i[2]},{name:i[1]},{class:r="range-slider-input "+i[9]},{list:l="tickmarks-"+i[2]},{"aria-label":i[7]},{min:i[3]},{max:i[4]},{step:i[5]},i[11]()],y={};for(let g=0;g<m.length;g+=1)y=ae(y,m[g]);let _=i[6]&&i[8]&&i[8].length&&Nt(i),b=i[12].trail&&Ot(i);return{c(){e=P("div"),c&&c.c(),t=F(),n=P("div"),s=P("input"),a=F(),_&&_.c(),o=F(),b&&b.c(),this.h()},l(g){e=C(g,"DIV",{class:!0,"data-testid":!0});var h=M(e);c&&c.l(h),t=B(h),n=C(h,"DIV",{class:!0});var k=M(n);s=C(k,"INPUT",{type:!0,id:!0,name:!0,class:!0,list:!0,"aria-label":!0,min:!0,max:!0,step:!0}),a=B(k),_&&_.l(k),k.forEach(v),o=B(h),b&&b.l(h),h.forEach(v),this.h()},h(){ge(s,y),T(n,"class","range-content "+hi),T(e,"class",u="range-slider "+i[10]),T(e,"data-testid","range-slider")},m(g,h){E(g,e,h),c&&c.m(e,null),I(e,t),I(e,n),I(n,s),s.autofocus&&s.focus(),Et(s,i[0]),I(n,a),_&&_.m(n,null),I(e,o),b&&b.m(e,null),p=!0,f||(d=[U(s,"change",i[19]),U(s,"input",i[19]),U(s,"click",i[16]),U(s,"change",i[17]),U(s,"blur",i[18])],f=!0)},p(g,[h]){g[12].default?c?(c.p(g,h),h&4096&&A(c,1)):(c=Ct(g),c.c(),A(c,1),c.m(e,t)):c&&(Q(),O(c,1,1,()=>{c=null}),$()),ge(s,y=qe(m,[{type:"range"},(!p||h&4)&&{id:g[2]},(!p||h&2)&&{name:g[1]},(!p||h&512&&r!==(r="range-slider-input "+g[9]))&&{class:r},(!p||h&4&&l!==(l="tickmarks-"+g[2]))&&{list:l},(!p||h&128)&&{"aria-label":g[7]},(!p||h&8)&&{min:g[3]},(!p||h&16)&&{max:g[4]},(!p||h&32)&&{step:g[5]},g[11]()])),h&1&&Et(s,g[0]),g[6]&&g[8]&&g[8].length?_?_.p(g,h):(_=Nt(g),_.c(),_.m(n,null)):_&&(_.d(1),_=null),g[12].trail?b?(b.p(g,h),h&4096&&A(b,1)):(b=Ot(g),b.c(),A(b,1),b.m(e,null)):b&&(Q(),O(b,1,1,()=>{b=null}),$()),(!p||h&1024&&u!==(u="range-slider "+g[10]))&&T(e,"class",u)},i(g){p||(A(c),A(b),p=!0)},o(g){O(c),O(b),p=!1},d(g){g&&v(e),c&&c.d(),_&&_.d(),b&&b.d(),f=!1,Ae(d)}}}const fi="space-y-2",di="",hi="flex justify-center py-2",mi="w-full h-2";function pi(i,e,t){let n,s;const r=["name","id","value","min","max","step","ticked","accent","label"];let l=je(e,r),{$$slots:a={},$$scope:o}=e;const u=Tn(a);let{name:p}=e,{id:f=String(Math.random())}=e,{value:d=0}=e,{min:c=0}=e,{max:m=100}=e,{step:y=1}=e,{ticked:_=!1}=e,{accent:b="accent-surface-900 dark:accent-surface-50"}=e,{label:g=""}=e,h;function k(){_!=!1&&t(8,h=Array.from({length:m-c+1},(S,oe)=>oe+c))}_&&k(),ni(()=>{k()});function L(){return delete l.class,l}function w(S){Z.call(this,i,S)}function R(S){Z.call(this,i,S)}function N(S){Z.call(this,i,S)}function z(){d=ii(this.value),t(0,d)}return i.$$set=S=>{t(22,e=ae(ae({},e),be(S))),t(21,l=je(e,r)),"name"in S&&t(1,p=S.name),"id"in S&&t(2,f=S.id),"value"in S&&t(0,d=S.value),"min"in S&&t(3,c=S.min),"max"in S&&t(4,m=S.max),"step"in S&&t(5,y=S.step),"ticked"in S&&t(6,_=S.ticked),"accent"in S&&t(13,b=S.accent),"label"in S&&t(7,g=S.label),"$$scope"in S&&t(14,o=S.$$scope)},i.$$.update=()=>{t(10,n=`${fi} ${e.class??""}`),i.$$.dirty&8192&&t(9,s=`${mi} ${b}`)},e=be(e),[d,p,f,c,m,y,_,g,h,s,n,L,u,b,o,a,w,R,N,z]}class gi extends ie{constructor(e){super(),se(this,e,pi,ci,re,{name:1,id:2,value:0,min:3,max:4,step:5,ticked:6,accent:13,label:7})}}function Dt(i){let e,t;const n=i[22].default,s=ft(n,i,i[21],null);return{c(){e=P("div"),s&&s.c(),this.h()},l(r){e=C(r,"DIV",{class:!0});var l=M(e);s&&s.l(l),l.forEach(v),this.h()},h(){T(e,"class","slide-toggle-text ml-3")},m(r,l){E(r,e,l),s&&s.m(e,null),t=!0},p(r,l){s&&s.p&&(!t||l[0]&2097152)&&dt(s,n,r,r[21],t?mt(n,r[21],l,null):ht(r[21]),null)},i(r){t||(A(s,r),t=!0)},o(r){O(s,r),t=!1},d(r){r&&v(e),s&&s.d(r)}}}function bi(i){let e,t,n,s,r,l,a,o,u,p,f,d,c,m,y,_=[{type:"checkbox"},{class:"slide-toggle-input hidden"},{name:i[1]},i[8](),{disabled:s=i[9].disabled}],b={};for(let h=0;h<_.length;h+=1)b=ae(b,_[h]);let g=i[10].default&&Dt(i);return{c(){e=P("div"),t=P("label"),n=P("input"),r=F(),l=P("div"),a=P("div"),p=F(),g&&g.c(),this.h()},l(h){e=C(h,"DIV",{id:!0,class:!0,"data-testid":!0,role:!0,"aria-label":!0,"aria-checked":!0,tabindex:!0});var k=M(e);t=C(k,"LABEL",{class:!0});var L=M(t);n=C(L,"INPUT",{type:!0,class:!0,name:!0}),r=B(L),l=C(L,"DIV",{class:!0});var w=M(l);a=C(w,"DIV",{class:!0}),M(a).forEach(v),w.forEach(v),p=B(L),g&&g.l(L),L.forEach(v),k.forEach(v),this.h()},h(){ge(n,b),T(a,"class",o="slide-toggle-thumb "+i[3]),Pe(a,"cursor-not-allowed",i[9].disabled),T(l,"class",u="slide-toggle-track "+i[4]),Pe(l,"cursor-not-allowed",i[9].disabled),T(t,"class",f="slide-toggle-label "+i[5]),T(e,"id",i[2]),T(e,"class",d="slide-toggle "+i[6]),T(e,"data-testid","slide-toggle"),T(e,"role","switch"),T(e,"aria-label",i[2]),T(e,"aria-checked",i[0]),T(e,"tabindex","0")},m(h,k){E(h,e,k),I(e,t),I(t,n),n.autofocus&&n.focus(),n.checked=i[0],I(t,r),I(t,l),I(l,a),I(t,p),g&&g.m(t,null),c=!0,m||(y=[U(n,"change",i[31]),U(n,"click",i[23]),U(n,"keydown",i[24]),U(n,"keyup",i[25]),U(n,"keypress",i[26]),U(n,"mouseover",i[27]),U(n,"change",i[28]),U(n,"focus",i[29]),U(n,"blur",i[30]),U(e,"keydown",i[7])],m=!0)},p(h,k){ge(n,b=qe(_,[{type:"checkbox"},{class:"slide-toggle-input hidden"},(!c||k[0]&2)&&{name:h[1]},h[8](),(!c||k[0]&512&&s!==(s=h[9].disabled))&&{disabled:s}])),k[0]&1&&(n.checked=h[0]),(!c||k[0]&8&&o!==(o="slide-toggle-thumb "+h[3]))&&T(a,"class",o),(!c||k[0]&520)&&Pe(a,"cursor-not-allowed",h[9].disabled),(!c||k[0]&16&&u!==(u="slide-toggle-track "+h[4]))&&T(l,"class",u),(!c||k[0]&528)&&Pe(l,"cursor-not-allowed",h[9].disabled),h[10].default?g?(g.p(h,k),k[0]&1024&&A(g,1)):(g=Dt(h),g.c(),A(g,1),g.m(t,null)):g&&(Q(),O(g,1,1,()=>{g=null}),$()),(!c||k[0]&32&&f!==(f="slide-toggle-label "+h[5]))&&T(t,"class",f),(!c||k[0]&4)&&T(e,"id",h[2]),(!c||k[0]&64&&d!==(d="slide-toggle "+h[6]))&&T(e,"class",d),(!c||k[0]&4)&&T(e,"aria-label",h[2]),(!c||k[0]&1)&&T(e,"aria-checked",h[0])},i(h){c||(A(g),c=!0)},o(h){O(g),c=!1},d(h){h&&v(e),g&&g.d(),m=!1,Ae(y)}}}const vi="inline-block",yi="unstyled flex items-center",_i="flex transition-all duration-[200ms] cursor-pointer",ki="w-[50%] h-full scale-[0.8] transition-all duration-[200ms] shadow";function Ti(i,e,t){let n,s,r,l,a,o,u,p;const f=["name","checked","size","background","active","border","rounded","label"];let d=je(e,f),{$$slots:c={},$$scope:m}=e;const y=Tn(c),_=We();let{name:b}=e,{checked:g=!1}=e,{size:h="md"}=e,{background:k="bg-surface-400 dark:bg-surface-700"}=e,{active:L="bg-surface-900 dark:bg-surface-300"}=e,{border:w=""}=e,{rounded:R="rounded-full"}=e,{label:N=""}=e,z;switch(h){case"sm":z="w-12 h-6";break;case"lg":z="w-20 h-10";break;default:z="w-16 h-8"}function S(D){["Enter","Space"].includes(D.code)&&(D.preventDefault(),_("keyup",D),D.target.firstChild.click())}function oe(){return delete d.class,d}function Ze(D){Z.call(this,i,D)}function Jn(D){Z.call(this,i,D)}function Yn(D){Z.call(this,i,D)}function Xn(D){Z.call(this,i,D)}function Zn(D){Z.call(this,i,D)}function Qn(D){Z.call(this,i,D)}function $n(D){Z.call(this,i,D)}function ei(D){Z.call(this,i,D)}function ti(){g=this.checked,t(0,g)}return i.$$set=D=>{t(9,e=ae(ae({},e),be(D))),t(33,d=je(e,f)),"name"in D&&t(1,b=D.name),"checked"in D&&t(0,g=D.checked),"size"in D&&t(11,h=D.size),"background"in D&&t(12,k=D.background),"active"in D&&t(13,L=D.active),"border"in D&&t(14,w=D.border),"rounded"in D&&t(15,R=D.rounded),"label"in D&&t(2,N=D.label),"$$scope"in D&&t(21,m=D.$$scope)},i.$$.update=()=>{i.$$.dirty[0]&12289&&t(19,n=g?L:`${k} cursor-pointer`),i.$$.dirty[0]&1&&t(18,s=g?"bg-white/75":"bg-white"),i.$$.dirty[0]&1&&t(17,r=g?"translate-x-full":""),t(20,l=e.disabled===!0?"opacity-50":"hover:brightness-[105%] dark:hover:brightness-110 cursor-pointer"),t(6,a=`${vi} ${R} ${l} ${e.class??""}`),i.$$.dirty[0]&638976&&t(4,u=`${_i} ${w} ${R} ${z} ${n}`),i.$$.dirty[0]&425984&&t(3,p=`${ki} ${R} ${s} ${r}`)},t(5,o=`${yi}`),e=be(e),[g,b,N,p,u,o,a,S,oe,e,y,h,k,L,w,R,z,r,s,n,l,m,c,Ze,Jn,Yn,Xn,Zn,Qn,$n,ei,ti]}class wi extends ie{constructor(e){super(),se(this,e,Ti,bi,re,{name:1,checked:0,size:11,background:12,active:13,border:14,rounded:15,label:2},null,[-1,-1])}}const Ei={namespaces:{tei:"http://www.tei-c.org/ns/1.0",teieg:"http://www.tei-c.org/ns/Examples",rng:"http://relaxng.org/ns/structure/1.0"},tei:{eg:["<pre>","</pre>"],ptr:['<a href="$rw@target">$@target</a>'],ref:[["[target]",['<a href="$rw@target">',"</a>"]]],graphic:function(i){let e=new Image;return e.src=this.rw(i.getAttribute("url")),i.hasAttribute("width")&&e.setAttribute("width",i.getAttribute("width")),i.hasAttribute("height")&&e.setAttribute("height",i.getAttribute("height")),e},list:[["[type=gloss]",function(i){const e=i.ownerDocument;let t=e.createElement("dl");for(let n of Array.from(i.children))if(n.nodeType==1){if(n.localName=="tei-label"){let s=e.createElement("dt");s.innerHTML=n.innerHTML,t.appendChild(s)}if(n.localName=="tei-item"){let s=e.createElement("dd");s.innerHTML=n.innerHTML,t.appendChild(s)}}return t}]],note:[["[place=end]",function(i){const e=i.ownerDocument;this.noteIndex?this.noteIndex++:this.noteIndex=1;let t="_note_"+this.noteIndex,n=e.createElement("a");n.setAttribute("id","src"+t),n.setAttribute("href","#"+t),n.innerHTML=this.noteIndex;let s=e.createElement("sup");s.appendChild(n);let r=e.querySelector("ol.notes");r||(r=e.createElement("ol"),r.setAttribute("class","notes"),this.dom.appendChild(r));let l=e.createElement("li");return l.id=t,l.innerHTML=i.innerHTML,r.appendChild(l),s}],["_",["(",")"]]],teiHeader:function(i){this.hideContent(i,!1)},title:[["tei-titlestmt>tei-title",function(i){const e=i.ownerDocument;let t=e.createElement("title");t.innerHTML=i.innerText,e.querySelector("head").appendChild(t)}]]},teieg:{egXML:function(i){let t=i.ownerDocument.createElement("pre"),n=this.serialize(i,!0).replace(/</g,"&lt;"),s=n.match(/^[\t ]+/);return s&&(n=n.replace(new RegExp("^"+s[0],"mg"),"")),t.innerHTML=n,t}}};function Ii(i,e){let t=1,n=i;for(;n&&n.previousElementSibling!==null&&(!e||n.previousElementSibling.localName==e)&&(t++,n=n.previousElementSibling,!!n.previousElementSibling););return t}function Si(i){const e=i.ownerDocument;let t=n=>{let s=n.nodeType===1?e.createElement(n.nodeName):n.cloneNode(!0);if(n.attributes)for(let r of Array.from(n.attributes))r.name!=="data-processed"&&s.setAttribute(r.name,r.value);for(let r of Array.from(n.childNodes))if(r.nodeType==1){if(!n.hasAttribute("data-empty"))if(r.hasAttribute("data-original")){for(let l of Array.from(r.childNodes)){let a=s.appendChild(t(l));a.nodeType===1&&a.hasAttribute("data-origid")&&(a.setAttribute("id",a.getAttribute("data-origid")),a.removeAttribute("data-origid"))}return s}else s.appendChild(t(r))}else s.appendChild(r.cloneNode());return s};return t(i)}function Ai(i){return i.replace(/ .*$/,"")}function Pn(i,e=!0){const t=i.ownerDocument;if(i.childNodes.length>0){let n=t.createElement("span");i.appendChild(n),n.setAttribute("hidden",""),n.setAttribute("data-original","");for(let s of Array.from(i.childNodes))if(s!==n){if(s.nodeType===1){s.setAttribute("data-processed","");for(let r of s.querySelectorAll("*"))r.setAttribute("data-processed","")}n.appendChild(i.removeChild(s))}if(e)for(let s of Array.from(n.querySelectorAll("*")))s.hasAttribute("id")&&(s.setAttribute("data-origid",s.getAttribute("id")),s.removeAttribute("id"))}}function Pi(i){return this.rw(this.first(i))}function Ci(i,e){let t="";for(let n=0;n<e;n++)t+=i;return t}function Ni(i){let e=this.prefixDefs[i.substring(0,i.indexOf(":"))];return i.replace(new RegExp(e.matchPattern),e.replacementPattern)}function Mi(i){return this.prefixDefs[i]}function Oi(i){return i.match(/^(?:http|mailto|file|\/|#).*$/)?i:this.base+this.utilities.first(i)}function nt(i,e,t){let n="",s=r=>!/[^\t\n\r ]/.test(r);if(!e&&i.nodeType==1){typeof t=="string"&&t!==""?n+=`
`+t+"<":n+="<",n+=i.getAttribute("data-origname");let r=i.hasAttribute("data-origatts")?i.getAttribute("data-origatts").split(" "):[];for(let l of Array.from(i.attributes))!l.name.startsWith("data-")&&!["id","lang","class"].includes(l.name)&&(n+=" "+r.find(function(a){return a.toLowerCase()==l.name})+'="'+l.value+'"'),l.name=="data-xmlns"&&(n+=' xmlns="'+l.value+'"');i.childNodes.length>0?n+=">":n+="/>"}for(let r of Array.from(i.childNodes))switch(r.nodeType){case 1:typeof t=="string"?n+=nt(r,!1,t+"  "):n+=nt(r,!1,t);break;case 7:n+="<?"+r.nodeValue+"?>";break;case 8:n+="<!--"+r.nodeValue+"-->";break;default:if(e&&s(r.nodeValue)&&(n+=r.nodeValue.replace(/^\s*\n/,"")),typeof t=="string"&&s(r.nodeValue))break;n+=r.nodeValue}return!e&&i.childNodes.length>0&&(typeof t=="string"?n+=`
`+t+"</":n+="</",n+=i.getAttribute("data-origname")+">"),n}function Di(i){return i.replace(/&gt;/,">").replace(/&quot;/,'"').replace(/&apos;/,"'").replace(/&amp;/,"&")}function Ue(i){return i.includes(":"),i.replace(/:/,"-").toLowerCase()}function Cn(i,e=null,t=!1){try{window.customElements.define(Ue(i),class extends HTMLElement{constructor(){super(),this.matches(":defined")||(e&&e.call(this),this.setAttribute("data-processed",""))}connectedCallback(){this.hasAttribute("data-processed")||(e&&e.call(this),this.setAttribute("data-processed",""))}})}catch(n){t&&(console.log(Ue(i)+" couldn't be registered or is already registered."),console.log(n))}}const Qe=Object.freeze(Object.defineProperty({__proto__:null,copyAndReset:Si,defineCustomElement:Cn,first:Ai,getOrdinality:Ii,getPrefixDef:Mi,hideContent:Pn,normalizeURI:Pi,repeat:Ci,resolveURI:Ni,rw:Oi,serialize:nt,tagName:Ue,unEscapeEntities:Di},Symbol.toStringTag,{value:"Module"}));function Li(i){if(i.namespaces)for(let e of Object.keys(i.namespaces))!this.namespaces.has(i.namespaces[e])&&!Array.from(this.namespaces.values()).includes(e)&&this.namespaces.set(i.namespaces[e],e);for(let e of this.namespaces.values())if(i[e])for(let t of Object.keys(i[e]))this.behaviors[`${e}:${t}`]=i[e][t];if(i.functions)for(let e of Object.keys(i.functions))this.utilities[e]=i.functions[e];i.handlers&&console.log("Behavior handlers are no longer used."),i.fallbacks&&console.log("Fallback behaviors are no longer used.")}function Fi(i,e,t){let n;if(i===Object(i))for(let s of Object.keys(i))this.namespaces.has(i[s])||(this.namespaces.set(i[s],s),n=s);else n=i;this.behaviors[`${n}:${e}`]=t}function Bi(i,e){let t;if(i===Object(i))for(let n of Object.keys(i))this.namespaces.has(i[n])||(this.namespaces.set(i[n],n),t=n);else t=i;delete this.behaviors[`${t}:${e}`]}function Hi(i,e){const t=i.documentElement;let n=1,s=function(l){return e.has(l.namespaceURI?l.namespaceURI:"")||e.set(l.namespaceURI,"ns"+n++),e.get(l.namespaceURI?l.namespaceURI:"")+":"+l.localName};const r=new Set(Array.from(t.querySelectorAll("*"),s));return r.add(s(t)),r}function ji(i){return Array.from(i.querySelectorAll("*[data-origname]"),e=>e.localName.replace(/(\w+)-.+/,"$1:")+e.getAttribute("data-origname"))}class pe{constructor(e){this.options=e||{},this.document=this.options.documentObject?this.options.documentObject:void 0,this.document===void 0&&(typeof window<"u"&&window.document?this.document=window.document:typeof global<"u"&&global.document&&(this.document=global.document)),this.addBehaviors=Li.bind(this),this.addBehavior=Fi.bind(this),this.removeBehavior=Bi.bind(this),this.utilities={};for(const t of Object.keys(Qe))["getPrefixDef","rw","resolveURI"].includes(t)?this.utilities[t]=Qe[t].bind(this):this.utilities[t]=Qe[t];if(this.els=[],this.namespaces=new Map,this.behaviors={},this.hasStyle=!1,this.prefixDefs=[],this.debug=this.options.debug===!0,this.discardContent=this.options.discardContent===!0,this.options.base)this.base=this.options.base;else try{window&&(this.base=window.location.href.replace(/\/[^\/]*$/,"/"))}catch{this.base=""}this.options.omitDefaultBehaviors||this.addBehaviors(Ei),this.options.ignoreFragmentId&&window&&window.removeEventListener("ceteiceanload",pe.restorePosition)}getHTML5(e,t,n){return window&&window.location.href.startsWith(this.base)&&e.indexOf("/")>=0&&(this.base=e.replace(/\/[^\/]*$/,"/")),new Promise(function(r,l){let a=new XMLHttpRequest;a.open("GET",e),a.send(),a.onload=function(){this.status>=200&&this.status<300?r(this.response):l(this.statusText)},a.onerror=function(){l(this.statusText)}}).catch(function(r){console.log("Could not get XML file."),this.debug&&console.log(r)}).then(r=>this.makeHTML5(r,t,n))}makeHTML5(e,t,n){return this.XML_dom=new DOMParser().parseFromString(e,"text/xml"),this.domToHTML5(this.XML_dom,t,n)}preprocess(e,t,n){this.els=Hi(e,this.namespaces);let s=r=>{let l;if(this.namespaces.has(r.namespaceURI?r.namespaceURI:"")){let a=this.namespaces.get(r.namespaceURI?r.namespaceURI:"");l=this.document.createElement(`${a}-${r.localName}`)}else l=this.document.importNode(r,!1);for(let a of Array.from(r.attributes))a.name=="xmlns"?l.setAttribute("data-xmlns",a.value):l.setAttribute(a.name,a.value),a.name=="xml:id"&&l.setAttribute("id",a.value),a.name=="xml:lang"&&l.setAttribute("lang",a.value),a.name=="rendition"&&l.setAttribute("class",a.value.replace(/#/g,""));if(l.setAttribute("data-origname",r.localName),r.hasAttributes()&&l.setAttribute("data-origatts",r.getAttributeNames().join(" ")),r.childNodes.length==0&&l.setAttribute("data-empty",""),r.localName=="head"){let a=e.evaluate("count(ancestor::*[tei:head])",r,function(o){if(o=="tei")return"http://www.tei-c.org/ns/1.0"},1,null);l.setAttribute("data-level",a.numberValue)}if(r.localName=="tagsDecl"){let a=this.document.createElement("style");for(let o of Array.from(r.childNodes))if(o.nodeType==1&&o.localName=="rendition"&&o.getAttribute("scheme")=="css"){let u="";o.hasAttribute("selector")?(u+=o.getAttribute("selector").replace(/([^#, >]+\w*)/g,"tei-$1").replace(/#tei-/g,"#")+`{
`,u+=o.textContent):(u+="."+o.getAttribute("xml:id")+`{
`,u+=o.textContent),u+=`
}
`,a.appendChild(this.document.createTextNode(u))}a.childNodes.length>0&&(l.appendChild(a),this.hasStyle=!0)}r.localName=="prefixDef"&&(this.prefixDefs.push(r.getAttribute("ident")),this.prefixDefs[r.getAttribute("ident")]={matchPattern:r.getAttribute("matchPattern"),replacementPattern:r.getAttribute("replacementPattern")});for(let a of Array.from(r.childNodes))a.nodeType==1?l.appendChild(s(a)):l.appendChild(a.cloneNode());return n&&n(l,r),l};if(this.dom=s(e.documentElement),this.utilities.dom=this.dom,t)t(this.dom,this),window&&window.dispatchEvent(Ce);else return typeof window<"u"&&window.dispatchEvent(Ce),this.dom}domToHTML5(e,t,n){if(this.preprocess(e,null,n),this.applyBehaviors(),this.done=!0,t)t(this.dom,this),window&&window.dispatchEvent(Ce);else return typeof window<"u"&&window.dispatchEvent(Ce),this.dom}processPage(){this.els=ji(this.document),this.applyBehaviors()}unsetNamespace(e){this.namespaces.delete(e)}setBaseUrl(e){this.base=e}append(e,t){let n=this;if(t){let s=e.call(n.utilities,t);s&&!n.childExists(t.firstElementChild,s.nodeName)&&n.appendBasic(t,s)}else return function(){if(!this.hasAttribute("data-processed")){let s=e.call(n.utilities,this);s&&!n.childExists(this.firstElementChild,s.nodeName)&&n.appendBasic(this,s)}}}appendBasic(e,t){this.discardContent?e.innerHTML="":Pn(e,!0),e.appendChild(t)}bName(e){return e.tagName.substring(0,e.tagName.indexOf("-")).toLowerCase()+":"+e.getAttribute("data-origname")}childExists(e,t){return e&&e.nodeName==t?!0:e&&e.nextElementSibling&&this.childExists(e.nextElementSibling,t)}decorator(e){if(Array.isArray(e)&&e.length==0)return function(n){};if(Array.isArray(e)&&!Array.isArray(e[0]))return this.applyDecorator(e);let t=this;return function(n){for(let s of e)if(n.matches(s[0])||s[0]==="_")return Array.isArray(s[1])?t.decorator(s[1]).call(this,n):s[1].call(this,n)}}applyDecorator(e){let t=this;return function(n){let s=[];for(let r=0;r<e.length;r++)s.push(t.template(e[r],n));return t.insert(n,s)}}getFallback(e,t){if(e[t])return e[t]instanceof Function?e[t]:this.decorator(e[t])}getHandler(e,t){if(e[t])return e[t]instanceof Function?this.append(e[t]):this.append(this.decorator(e[t]))}insert(e,t){let n=this.document.createElement("span");for(let s of Array.from(e.childNodes))s.nodeType===1&&!s.hasAttribute("data-processed")&&this.processElement(s);if(t[0].match("<[^>]+>")&&t[1]&&t[1].match("<[^>]+>"))n.innerHTML=t[0]+e.innerHTML+(t[1]?t[1]:"");else{n.innerHTML=t[0],n.setAttribute("data-before",t[0].replace(/<[^>]+>/g,"").length);for(let s of Array.from(e.childNodes))n.appendChild(s.cloneNode(!0));t.length>1&&(n.innerHTML+=t[1],n.setAttribute("data-after",t[1].replace(/<[^>]+>/g,"").length))}return n}processElement(e){if(e.hasAttribute("data-origname")&&!e.hasAttribute("data-processed")){let t=this.getFallback(this.bName(e));t&&(this.append(t,e),e.setAttribute("data-processed",""))}for(let t of Array.from(e.childNodes))t.nodeType===1&&this.processElement(t)}template(e,t){let n=e;if(e.search(/\$(\w*)(@([a-zA-Z:]+))/)){let s=/\$(\w*)@([a-zA-Z:]+)/g,r;for(;r=s.exec(e);)t.hasAttribute(r[2])?r[1]&&this.utilities[r[1]]?n=n.replace(r[0],this.utilities[r[1]](t.getAttribute(r[2]))):n=n.replace(r[0],t.getAttribute(r[2])):n=n.replace(r[0],"")}return n}applyBehaviors(){typeof window<"u"&&window.customElements?this.define.call(this,this.els):this.fallback.call(this,this.els)}define(e){for(let t of e){const n=this.getHandler(this.behaviors,t);Cn(t,n,this.debug)}}fallback(e){for(let t of e){let n=this.getFallback(this.behaviors,t);if(n)for(let s of Array.from((this.dom&&!this.done?this.dom:this.document).getElementsByTagName(Ue(t))))s.hasAttribute("data-processed")||this.append(n,s)}}static savePosition(){window.sessionStorage.setItem(window.location+"-scroll",window.scrollY)}static restorePosition(){if(window.location.hash)setTimeout(function(){let e=this.document.querySelector(window.decodeURI(window.location.hash));e&&e.scrollIntoView()},100);else{let e;(e=window.sessionStorage.getItem(window.location+"-scroll"))&&setTimeout(function(){window.scrollTo(0,e)},100)}}}try{if(typeof window<"u"){window.CETEI=pe,window.addEventListener("beforeunload",pe.savePosition);var Ce=new Event("ceteiceanload");window.addEventListener("ceteiceanload",pe.restorePosition)}}catch(i){console.log(i)}let xi={tei:{note:[["[type=gloss]",function(i){this.noteIndex?this.noteIndex++:this.noteIndex=1;let e="note"+this.noteIndex,t=document.createElement("a");t.setAttribute("id","src"+e),t.setAttribute("href","#"+e),t.innerHTML=this.noteIndex;let n=document.createElement("sup");n.appendChild(t);let s=this.dom.querySelector("ol.notes");s||(s=document.createElement("ol"),s.setAttribute("class","notes"),this.dom.appendChild(s));let r=document.createElement("li");return r.id=e,r.innerHTML='<a href="#src'+e+'">^</a> '+i.innerHTML,s.appendChild(r),n}],["[type=side-note]",function(i){i.style.fontSize="0.75em",i.style.marginLeft="1em",i.style.fontStyle="italic"}]]}};const{document:Lt}=ri;function Ft(i){let e,t;return e=new Sn({}),{c(){q(e.$$.fragment)},l(n){W(e.$$.fragment,n)},m(n,s){K(e,n,s),t=!0},i(n){t||(A(e.$$.fragment,n),t=!0)},o(n){O(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function Bt(i){let e,t;return{c(){e=P("p"),t=j(i[1]),this.h()},l(n){e=C(n,"P",{"data-testid":!0});var s=M(e);t=x(s,i[1]),s.forEach(v),this.h()},h(){T(e,"data-testid","error-message")},m(n,s){E(n,e,s),I(e,t)},p(n,s){s&2&&X(t,n[1])},d(n){n&&v(e)}}}function Ri(i){let e,t,n,s,r,l=!i[0]&&Ft(),a=i[1]&&Bt(i);return{c(){e=P("link"),t=F(),n=P("div"),l&&l.c(),s=F(),a&&a.c(),this.h()},l(o){const u=si("svelte-1rxmp49",Lt.head);e=C(u,"LINK",{rel:!0,type:!0,href:!0}),u.forEach(v),t=B(o),n=C(o,"DIV",{id:!0,"data-testid":!0});var p=M(n);l&&l.l(p),s=B(p),a&&a.l(p),p.forEach(v),this.h()},h(){T(e,"rel","stylesheet"),T(e,"type","text/css"),T(e,"href",pt+"/additional-style/TEIstyle.css"),T(n,"id","TEI-container"),T(n,"data-testid","TEI-container")},m(o,u){I(Lt.head,e),E(o,t,u),E(o,n,u),l&&l.m(n,null),I(n,s),a&&a.m(n,null),r=!0},p(o,[u]){o[0]?l&&(Q(),O(l,1,1,()=>{l=null}),$()):l?u&1&&A(l,1):(l=Ft(),l.c(),A(l,1),l.m(n,s)),o[1]?a?a.p(o,u):(a=Bt(o),a.c(),a.m(n,null)):a&&(a.d(1),a=null)},i(o){r||(A(l),r=!0)},o(o){O(l),r=!1},d(o){v(e),o&&v(t),o&&v(n),l&&l.d(),a&&a.d()}}}function zi(i,e,t){let n=!1,s,{path:r=""}=e;return Ke(async()=>{try{if(r==="")throw"No path specified";var l=new pe;l.addBehaviors(xi),l.getHTML5(r,function(a){document.getElementById("TEI-container").appendChild(a)}),t(0,n=!0)}catch(a){t(1,s=a.toString()),t(0,n=!0);return}}),i.$$set=l=>{"path"in l&&t(2,r=l.path)},[n,s,r]}class Ui extends ie{constructor(e){super(),se(this,e,zi,Ri,re,{path:2})}}function Vi(i){let e,t,n;return{c(){e=P("audio"),t=P("source"),this.h()},l(s){e=C(s,"AUDIO",{});var r=M(e);t=C(r,"SOURCE",{src:!0,type:!0}),r.forEach(v),this.h()},h(){It(t.src,n=i[0])||T(t,"src",n),T(t,"type","audio/mpeg"),e.controls=!0},m(s,r){E(s,e,r),I(e,t)},p(s,[r]){r&1&&!It(t.src,n=s[0])&&T(t,"src",n)},i:G,o:G,d(s){s&&v(e)}}}function Gi(i,e,t){let{audioPath:n}=e;return i.$$set=s=>{"audioPath"in s&&t(0,n=s.audioPath)},[n]}class qi extends ie{constructor(e){super(),se(this,e,Gi,Vi,re,{audioPath:0})}}function Oe(i){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Oe=function(e){return typeof e}:Oe=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oe(i)}function gt(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function Ht(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}function bt(i,e,t){return e&&Ht(i.prototype,e),t&&Ht(i,t),i}var ne={VERSION:"2.0.16",NOTES:[],HEADER_CHUNK_LENGTH:14,CIRCLE_OF_FOURTHS:["C","F","Bb","Eb","Ab","Db","Gb","Cb","Fb","Bbb","Ebb","Abb"],CIRCLE_OF_FIFTHS:["C","G","D","A","E","B","F#","C#","G#","D#","A#","E#"]},Wi=[["C"],["C#","Db"],["D"],["D#","Eb"],["E"],["F"],["F#","Gb"],["G"],["G#","Ab"],["A"],["A#","Bb"],["B"]],jt=0,Ki=function(e){Wi.forEach(function(t){t.forEach(function(n){return ne.NOTES[jt]=n+e}),jt++})};for(var $e=-1;$e<=9;$e++)Ki($e);var V=function(){function i(){gt(this,i)}return bt(i,null,[{key:"byteToHex",value:function(t){return("0"+t.toString(16)).slice(-2)}},{key:"bytesToHex",value:function(t){var n=[];return t.forEach(function(s){return n.push(i.byteToHex(s))}),n.join("")}},{key:"hexToNumber",value:function(t){return parseInt(t,16)}},{key:"bytesToNumber",value:function(t){return i.hexToNumber(i.bytesToHex(t))}},{key:"bytesToLetters",value:function(t){var n=[];return t.forEach(function(s){return n.push(String.fromCharCode(s))}),n.join("")}},{key:"decToBinary",value:function(t){return(t>>>0).toString(2)}},{key:"getVarIntLength",value:function(t){for(var n=t[0],s=1;n>=128;)n=t[s],s++;return s}},{key:"readVarInt",value:function(t){var n=0;return t.forEach(function(s){var r=s;r&128?(n+=r&127,n<<=7):n+=r}),n}},{key:"atob",value:function(e){function t(n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return typeof atob=="function"?atob(e):Buffer.from(e,"base64").toString("binary")})}]),i}(),Ji=function(){function i(e,t){gt(this,i),this.enabled=!0,this.eventIndex=0,this.pointer=0,this.lastTick=0,this.lastStatus=null,this.index=e,this.data=t,this.delta=0,this.runningDelta=0,this.events=[];var n=this.data.subarray(this.data.length-3,this.data.length);if(!(n[0]===255&&n[1]===47&&n[2]===0))throw"Invalid MIDI file; Last three bytes of track "+this.index+"must be FF 2F 00 to mark end of track"}return bt(i,[{key:"reset",value:function(){return this.enabled=!0,this.eventIndex=0,this.pointer=0,this.lastTick=0,this.lastStatus=null,this.delta=0,this.runningDelta=0,this}},{key:"enable",value:function(){return this.enabled=!0,this}},{key:"disable",value:function(){return this.enabled=!1,this}},{key:"setEventIndexByTick",value:function(t){t=t||0;for(var n in this.events)if(this.events[n].tick>=t)return this.eventIndex=n,this}},{key:"getCurrentByte",value:function(){return this.data[this.pointer]}},{key:"getDeltaByteCount",value:function(){return V.getVarIntLength(this.data.subarray(this.pointer))}},{key:"getDelta",value:function(){return V.readVarInt(this.data.subarray(this.pointer,this.pointer+this.getDeltaByteCount()))}},{key:"handleEvent",value:function(t,n){if(n=n||!1,n){var s=t-this.lastTick,r=this.getDelta(),l=s>=r;if(this.pointer<this.data.length&&(n||l)){var a=this.parseEvent();if(this.enabled)return a}}else if(this.events[this.eventIndex]&&this.events[this.eventIndex].tick<=t&&(this.eventIndex++,this.enabled))return this.events[this.eventIndex-1];return null}},{key:"getStringData",value:function(t){var n=V.getVarIntLength(this.data.subarray(t+2)),s=V.readVarInt(this.data.subarray(t+2,t+2+n)),r=V.bytesToLetters(this.data.subarray(t+2+n,t+2+n+s));return r}},{key:"parseEvent",value:function(){var t=this.pointer+this.getDeltaByteCount(),n={},s=this.getDeltaByteCount();if(n.track=this.index+1,n.delta=this.getDelta(),this.lastTick=this.lastTick+n.delta,this.runningDelta+=n.delta,n.tick=this.runningDelta,n.byteIndex=this.pointer,this.data[t]==255){switch(this.data[t+1]){case 0:n.name="Sequence Number";break;case 1:n.name="Text Event",n.string=this.getStringData(t);break;case 2:n.name="Copyright Notice";break;case 3:n.name="Sequence/Track Name",n.string=this.getStringData(t);break;case 4:n.name="Instrument Name",n.string=this.getStringData(t);break;case 5:n.name="Lyric",n.string=this.getStringData(t);break;case 6:n.name="Marker";break;case 7:n.name="Cue Point",n.string=this.getStringData(t);break;case 9:n.name="Device Name",n.string=this.getStringData(t);break;case 32:n.name="MIDI Channel Prefix";break;case 33:n.name="MIDI Port",n.data=V.bytesToNumber([this.data[t+3]]);break;case 47:n.name="End of Track";break;case 81:n.name="Set Tempo",n.data=Math.round(6e7/V.bytesToNumber(this.data.subarray(t+3,t+6))),this.tempo=n.data;break;case 84:n.name="SMTPE Offset";break;case 88:n.name="Time Signature",n.data=this.data.subarray(t+3,t+7),n.timeSignature=""+n.data[0]+"/"+Math.pow(2,n.data[1]);break;case 89:n.name="Key Signature",n.data=this.data.subarray(t+3,t+5),n.data[0]>=0?n.keySignature=ne.CIRCLE_OF_FIFTHS[n.data[0]]:n.data[0]<0&&(n.keySignature=ne.CIRCLE_OF_FOURTHS[Math.abs(n.data[0])]),n.data[1]==0?n.keySignature+=" Major":n.data[1]==1&&(n.keySignature+=" Minor");break;case 127:n.name="Sequencer-Specific Meta-event";break;default:n.name="Unknown: "+this.data[t+1].toString(16);break}var r=V.getVarIntLength(this.data.subarray(t+2)),l=V.readVarInt(this.data.subarray(t+2,t+2+r));this.pointer+=s+3+l}else if(this.data[t]===240){n.name="Sysex";var a=V.getVarIntLength(this.data.subarray(t+1)),o=V.readVarInt(this.data.subarray(t+1,t+1+a));n.data=this.data.subarray(t+1+a,t+1+a+o),this.pointer+=s+1+a+o}else if(this.data[t]===247){n.name="Sysex (escape)";var u=V.getVarIntLength(this.data.subarray(t+1)),p=V.readVarInt(this.data.subarray(t+1,t+1+u));n.data=this.data.subarray(t+1+u,t+1+u+p),this.pointer+=s+1+u+p}else if(this.data[t]<128)if(n.running=!0,n.noteNumber=this.data[t],n.noteName=ne.NOTES[this.data[t]],n.velocity=this.data[t+1],this.lastStatus<=143)n.name="Note off",n.channel=this.lastStatus-128+1,this.pointer+=s+2;else if(this.lastStatus<=159)n.name="Note on",n.channel=this.lastStatus-144+1,this.pointer+=s+2;else if(this.lastStatus<=175)n.name="Polyphonic Key Pressure",n.channel=this.lastStatus-160+1,n.note=ne.NOTES[this.data[t+1]],n.pressure=event[1],this.pointer+=s+2;else if(this.lastStatus<=191)n.name="Controller Change",n.channel=this.lastStatus-176+1,n.number=this.data[t+1],n.value=this.data[t+2],this.pointer+=s+2;else if(this.lastStatus<=207)n.name="Program Change",n.channel=this.lastStatus-192+1,n.value=this.data[t+1],this.pointer+=s+1;else if(this.lastStatus<=223)n.name="Channel Key Pressure",n.channel=this.lastStatus-208+1,this.pointer+=s+1;else if(this.lastStatus<=239)n.name="Pitch Bend",n.channel=this.lastStatus-224+1,n.value=this.data[t+2],this.pointer+=s+2;else throw"Unknown event (running): ".concat(this.lastStatus);else if(this.lastStatus=this.data[t],this.data[t]<=143)n.name="Note off",n.channel=this.lastStatus-128+1,n.noteNumber=this.data[t+1],n.noteName=ne.NOTES[this.data[t+1]],n.velocity=Math.round(this.data[t+2]/127*100),this.pointer+=s+3;else if(this.data[t]<=159)n.name="Note on",n.channel=this.lastStatus-144+1,n.noteNumber=this.data[t+1],n.noteName=ne.NOTES[this.data[t+1]],n.velocity=Math.round(this.data[t+2]/127*100),this.pointer+=s+3;else if(this.data[t]<=175)n.name="Polyphonic Key Pressure",n.channel=this.lastStatus-160+1,n.note=ne.NOTES[this.data[t+1]],n.pressure=event[2],this.pointer+=s+3;else if(this.data[t]<=191)n.name="Controller Change",n.channel=this.lastStatus-176+1,n.number=this.data[t+1],n.value=this.data[t+2],this.pointer+=s+3;else if(this.data[t]<=207)n.name="Program Change",n.channel=this.lastStatus-192+1,n.value=this.data[t+1],this.pointer+=s+2;else if(this.data[t]<=223)n.name="Channel Key Pressure",n.channel=this.lastStatus-208+1,this.pointer+=s+2;else if(this.data[t]<=239)n.name="Pitch Bend",n.channel=this.lastStatus-224+1,this.pointer+=s+3;else throw"Unknown event: ".concat(this.data[t]);return this.delta+=n.delta,this.events.push(n),n}},{key:"endOfTrack",value:function(){return this.data[this.pointer+1]==255&&this.data[this.pointer+2]==47&&this.data[this.pointer+3]==0}}]),i}();Uint8Array.prototype.forEach||Object.defineProperty(Uint8Array.prototype,"forEach",{value:Array.prototype.forEach});var Yi=function(){function i(e,t){gt(this,i),this.sampleRate=5,this.startTime=0,this.buffer=t||null,this.midiChunksByteLength=null,this.division,this.format,this.setIntervalId=!1,this.tracks=[],this.instruments=[],this.defaultTempo=120,this.tempo=null,this.startTick=0,this.tick=0,this.lastTick=null,this.inLoop=!1,this.totalTicks=0,this.events=[],this.totalEvents=0,this.eventListeners={},typeof e=="function"&&this.on("midiEvent",e)}return bt(i,[{key:"loadFile",value:function(t){throw"loadFile is only supported on Node.js"}},{key:"loadArrayBuffer",value:function(t){return this.buffer=new Uint8Array(t),this.fileLoaded()}},{key:"loadDataUri",value:function(t){for(var n=V.atob(t.split(",")[1]),s=new Uint8Array(n.length),r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return this.buffer=s,this.fileLoaded()}},{key:"getFilesize",value:function(){return this.buffer?this.buffer.length:0}},{key:"fileLoaded",value:function(){if(!this.validate())throw"Invalid MIDI file; should start with MThd";return this.setTempo(this.defaultTempo).getDivision().getFormat().getTracks().dryRun()}},{key:"validate",value:function(){return V.bytesToLetters(this.buffer.subarray(0,4))==="MThd"}},{key:"getFormat",value:function(){return this.format=V.bytesToNumber(this.buffer.subarray(8,10)),this}},{key:"getTracks",value:function(){this.tracks=[];for(var t=0;t<this.buffer.length;){if(V.bytesToLetters(this.buffer.subarray(t,t+4))=="MTrk"){var n=V.bytesToNumber(this.buffer.subarray(t+4,t+8));this.tracks.push(new Ji(this.tracks.length,this.buffer.subarray(t+8,t+8+n)))}t+=V.bytesToNumber(this.buffer.subarray(t+4,t+8))+8}var s=0;return this.tracks.forEach(function(r){s+=8+r.data.length}),this.midiChunksByteLength=ne.HEADER_CHUNK_LENGTH+s,this}},{key:"enableTrack",value:function(t){return this.tracks[t-1].enable(),this}},{key:"disableTrack",value:function(t){return this.tracks[t-1].disable(),this}},{key:"getDivision",value:function(){return this.division=V.bytesToNumber(this.buffer.subarray(12,ne.HEADER_CHUNK_LENGTH)),this}},{key:"playLoop",value:function(t){this.inLoop||(this.inLoop=!0,this.tick=this.getCurrentTick(),this.tracks.forEach(function(n,s){if(!t&&this.endOfFile())this.triggerPlayerEvent("endOfFile"),this.stop();else{var r=n.handleEvent(this.tick,t);t&&r?(r.hasOwnProperty("name")&&r.name==="Set Tempo"&&(this.defaultTempo=r.data,this.setTempo(r.data)),r.hasOwnProperty("name")&&r.name==="Program Change"&&(this.instruments.includes(r.value)||this.instruments.push(r.value))):r&&(r.hasOwnProperty("name")&&r.name==="Set Tempo"&&(this.setTempo(r.data),this.isPlaying()&&this.pause().play()),this.emitEvent(r))}},this),t||this.triggerPlayerEvent("playing",{tick:this.tick}),this.inLoop=!1)}},{key:"setTempo",value:function(t){return this.tempo=t,this}},{key:"setStartTime",value:function(t){return this.startTime=t,this}},{key:"play",value:function(){if(this.isPlaying())throw"Already playing...";return this.startTime||(this.startTime=new Date().getTime()),this.setIntervalId=setInterval(this.playLoop.bind(this),this.sampleRate),this}},{key:"loop",value:function(){setTimeout(function(){this.playLoop(),this.loop()}.bind(this),this.sampleRate)}},{key:"pause",value:function(){return clearInterval(this.setIntervalId),this.setIntervalId=!1,this.startTick=this.tick,this.startTime=0,this}},{key:"stop",value:function(){return clearInterval(this.setIntervalId),this.setIntervalId=!1,this.startTick=0,this.startTime=0,this.resetTracks(),this}},{key:"skipToTick",value:function(t){return this.stop(),this.startTick=t,this.tracks.forEach(function(n){n.setEventIndexByTick(t)}),this}},{key:"skipToPercent",value:function(t){if(t<0||t>100)throw"Percent must be number between 1 and 100.";return this.skipToTick(Math.round(t/100*this.totalTicks)),this}},{key:"skipToSeconds",value:function(t){var n=this.getSongTime();if(t<0||t>n)throw t+" seconds not within song time of "+n;return this.skipToPercent(t/n*100),this}},{key:"isPlaying",value:function(){return this.setIntervalId>0||Oe(this.setIntervalId)==="object"}},{key:"dryRun",value:function(){for(this.resetTracks();!this.endOfFile();)this.playLoop(!0);return this.events=this.getEvents(),this.totalEvents=this.getTotalEvents(),this.totalTicks=this.getTotalTicks(),this.startTick=0,this.startTime=0,this.resetTracks(),this.triggerPlayerEvent("fileLoaded",this),this}},{key:"resetTracks",value:function(){return this.tracks.forEach(function(t){return t.reset()}),this}},{key:"getEvents",value:function(){return this.tracks.map(function(t){return t.events})}},{key:"getTotalTicks",value:function(){return Math.max.apply(null,this.tracks.map(function(t){return t.delta}))}},{key:"getTotalEvents",value:function(){return this.tracks.reduce(function(t,n){return{events:{length:t.events.length+n.events.length}}},{events:{length:0}}).events.length}},{key:"getSongTime",value:function(){return this.totalTicks/this.division/this.tempo*60}},{key:"getSongTimeRemaining",value:function(){return Math.round((this.totalTicks-this.getCurrentTick())/this.division/this.tempo*60)}},{key:"getSongPercentRemaining",value:function(){return Math.round(this.getSongTimeRemaining()/this.getSongTime()*100)}},{key:"bytesProcessed",value:function(){return ne.HEADER_CHUNK_LENGTH+this.tracks.length*8+this.tracks.reduce(function(t,n){return{pointer:t.pointer+n.pointer}},{pointer:0}).pointer}},{key:"eventsPlayed",value:function(){return this.tracks.reduce(function(t,n){return{eventIndex:t.eventIndex+n.eventIndex}},{eventIndex:0}).eventIndex}},{key:"endOfFile",value:function(){return this.isPlaying()?this.totalTicks-this.tick<=0:this.bytesProcessed()>=this.midiChunksByteLength}},{key:"getCurrentTick",value:function(){return this.startTime?Math.round((new Date().getTime()-this.startTime)/1e3*(this.division*(this.tempo/60)))+this.startTick:this.startTick}},{key:"emitEvent",value:function(t){return this.triggerPlayerEvent("midiEvent",t),this}},{key:"on",value:function(t,n){return this.eventListeners.hasOwnProperty(t)||(this.eventListeners[t]=[]),this.eventListeners[t].push(n),this}},{key:"triggerPlayerEvent",value:function(t,n){return this.eventListeners.hasOwnProperty(t)&&this.eventListeners[t].forEach(function(s){return s(n||{})}),this}}]),i}(),Xi={Player:Yi,Utils:V,Constants:ne};const Ee=/^[a-z0-9]+(-[a-z0-9]+)*$/,Je=(i,e,t,n="")=>{const s=i.split(":");if(i.slice(0,1)==="@"){if(s.length<2||s.length>3)return null;n=s.shift().slice(1)}if(s.length>3||!s.length)return null;if(s.length>1){const a=s.pop(),o=s.pop(),u={provider:s.length>0?s[0]:n,prefix:o,name:a};return e&&!De(u)?null:u}const r=s[0],l=r.split("-");if(l.length>1){const a={provider:n,prefix:l.shift(),name:l.join("-")};return e&&!De(a)?null:a}if(t&&n===""){const a={provider:n,prefix:"",name:r};return e&&!De(a,t)?null:a}return null},De=(i,e)=>i?!!((i.provider===""||i.provider.match(Ee))&&(e&&i.prefix===""||i.prefix.match(Ee))&&i.name.match(Ee)):!1,Nn=Object.freeze({left:0,top:0,width:16,height:16}),Ve=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),Ye=Object.freeze({...Nn,...Ve}),it=Object.freeze({...Ye,body:"",hidden:!1});function Zi(i,e){const t={};!i.hFlip!=!e.hFlip&&(t.hFlip=!0),!i.vFlip!=!e.vFlip&&(t.vFlip=!0);const n=((i.rotate||0)+(e.rotate||0))%4;return n&&(t.rotate=n),t}function xt(i,e){const t=Zi(i,e);for(const n in it)n in Ve?n in i&&!(n in t)&&(t[n]=Ve[n]):n in e?t[n]=e[n]:n in i&&(t[n]=i[n]);return t}function Qi(i,e){const t=i.icons,n=i.aliases||Object.create(null),s=Object.create(null);function r(l){if(t[l])return s[l]=[];if(!(l in s)){s[l]=null;const a=n[l]&&n[l].parent,o=a&&r(a);o&&(s[l]=[a].concat(o))}return s[l]}return(e||Object.keys(t).concat(Object.keys(n))).forEach(r),s}function $i(i,e,t){const n=i.icons,s=i.aliases||Object.create(null);let r={};function l(a){r=xt(n[a]||s[a],r)}return l(e),t.forEach(l),xt(i,r)}function Mn(i,e){const t=[];if(typeof i!="object"||typeof i.icons!="object")return t;i.not_found instanceof Array&&i.not_found.forEach(s=>{e(s,null),t.push(s)});const n=Qi(i);for(const s in n){const r=n[s];r&&(e(s,$i(i,s,r)),t.push(s))}return t}const es={provider:"",aliases:{},not_found:{},...Nn};function et(i,e){for(const t in e)if(t in i&&typeof i[t]!=typeof e[t])return!1;return!0}function On(i){if(typeof i!="object"||i===null)return null;const e=i;if(typeof e.prefix!="string"||!i.icons||typeof i.icons!="object"||!et(i,es))return null;const t=e.icons;for(const s in t){const r=t[s];if(!s.match(Ee)||typeof r.body!="string"||!et(r,it))return null}const n=e.aliases||Object.create(null);for(const s in n){const r=n[s],l=r.parent;if(!s.match(Ee)||typeof l!="string"||!t[l]&&!n[l]||!et(r,it))return null}return e}const Rt=Object.create(null);function ts(i,e){return{provider:i,prefix:e,icons:Object.create(null),missing:new Set}}function fe(i,e){const t=Rt[i]||(Rt[i]=Object.create(null));return t[e]||(t[e]=ts(i,e))}function vt(i,e){return On(e)?Mn(e,(t,n)=>{n?i.icons[t]=n:i.missing.add(t)}):[]}function ns(i,e,t){try{if(typeof t.body=="string")return i.icons[e]={...t},!0}catch{}return!1}let Ie=!1;function Dn(i){return typeof i=="boolean"&&(Ie=i),Ie}function is(i){const e=typeof i=="string"?Je(i,!0,Ie):i;if(e){const t=fe(e.provider,e.prefix),n=e.name;return t.icons[n]||(t.missing.has(n)?null:void 0)}}function ss(i,e){const t=Je(i,!0,Ie);if(!t)return!1;const n=fe(t.provider,t.prefix);return ns(n,t.name,e)}function rs(i,e){if(typeof i!="object")return!1;if(typeof e!="string"&&(e=i.provider||""),Ie&&!e&&!i.prefix){let s=!1;return On(i)&&(i.prefix="",Mn(i,(r,l)=>{l&&ss(r,l)&&(s=!0)})),s}const t=i.prefix;if(!De({provider:e,prefix:t,name:"a"}))return!1;const n=fe(e,t);return!!vt(n,i)}const Ln=Object.freeze({width:null,height:null}),Fn=Object.freeze({...Ln,...Ve}),ls=/(-?[0-9.]*[0-9]+[0-9.]*)/g,as=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function zt(i,e,t){if(e===1)return i;if(t=t||100,typeof i=="number")return Math.ceil(i*e*t)/t;if(typeof i!="string")return i;const n=i.split(ls);if(n===null||!n.length)return i;const s=[];let r=n.shift(),l=as.test(r);for(;;){if(l){const a=parseFloat(r);isNaN(a)?s.push(r):s.push(Math.ceil(a*e*t)/t)}else s.push(r);if(r=n.shift(),r===void 0)return s.join("");l=!l}}const os=i=>i==="unset"||i==="undefined"||i==="none";function us(i,e){const t={...Ye,...i},n={...Fn,...e},s={left:t.left,top:t.top,width:t.width,height:t.height};let r=t.body;[t,n].forEach(m=>{const y=[],_=m.hFlip,b=m.vFlip;let g=m.rotate;_?b?g+=2:(y.push("translate("+(s.width+s.left).toString()+" "+(0-s.top).toString()+")"),y.push("scale(-1 1)"),s.top=s.left=0):b&&(y.push("translate("+(0-s.left).toString()+" "+(s.height+s.top).toString()+")"),y.push("scale(1 -1)"),s.top=s.left=0);let h;switch(g<0&&(g-=Math.floor(g/4)*4),g=g%4,g){case 1:h=s.height/2+s.top,y.unshift("rotate(90 "+h.toString()+" "+h.toString()+")");break;case 2:y.unshift("rotate(180 "+(s.width/2+s.left).toString()+" "+(s.height/2+s.top).toString()+")");break;case 3:h=s.width/2+s.left,y.unshift("rotate(-90 "+h.toString()+" "+h.toString()+")");break}g%2===1&&(s.left!==s.top&&(h=s.left,s.left=s.top,s.top=h),s.width!==s.height&&(h=s.width,s.width=s.height,s.height=h)),y.length&&(r='<g transform="'+y.join(" ")+'">'+r+"</g>")});const l=n.width,a=n.height,o=s.width,u=s.height;let p,f;l===null?(f=a===null?"1em":a==="auto"?u:a,p=zt(f,o/u)):(p=l==="auto"?o:l,f=a===null?zt(p,u/o):a==="auto"?u:a);const d={},c=(m,y)=>{os(y)||(d[m]=y.toString())};return c("width",p),c("height",f),d.viewBox=s.left.toString()+" "+s.top.toString()+" "+o.toString()+" "+u.toString(),{attributes:d,body:r}}const cs=/\sid="(\S+)"/g,fs="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let ds=0;function hs(i,e=fs){const t=[];let n;for(;n=cs.exec(i);)t.push(n[1]);if(!t.length)return i;const s="suffix"+(Math.random()*16777216|Date.now()).toString(16);return t.forEach(r=>{const l=typeof e=="function"?e(r):e+(ds++).toString(),a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");i=i.replace(new RegExp('([#;"])('+a+')([")]|\\.[a-z])',"g"),"$1"+l+s+"$3")}),i=i.replace(new RegExp(s,"g"),""),i}const st=Object.create(null);function ms(i,e){st[i]=e}function rt(i){return st[i]||st[""]}function yt(i){let e;if(typeof i.resources=="string")e=[i.resources];else if(e=i.resources,!(e instanceof Array)||!e.length)return null;return{resources:e,path:i.path||"/",maxURL:i.maxURL||500,rotate:i.rotate||750,timeout:i.timeout||5e3,random:i.random===!0,index:i.index||0,dataAfterTimeout:i.dataAfterTimeout!==!1}}const _t=Object.create(null),_e=["https://api.simplesvg.com","https://api.unisvg.com"],Le=[];for(;_e.length>0;)_e.length===1||Math.random()>.5?Le.push(_e.shift()):Le.push(_e.pop());_t[""]=yt({resources:["https://api.iconify.design"].concat(Le)});function ps(i,e){const t=yt(e);return t===null?!1:(_t[i]=t,!0)}function kt(i){return _t[i]}const gs=()=>{let i;try{if(i=fetch,typeof i=="function")return i}catch{}};let Ut=gs();function bs(i,e){const t=kt(i);if(!t)return 0;let n;if(!t.maxURL)n=0;else{let s=0;t.resources.forEach(l=>{s=Math.max(s,l.length)});const r=e+".json?icons=";n=t.maxURL-s-t.path.length-r.length}return n}function vs(i){return i===404}const ys=(i,e,t)=>{const n=[],s=bs(i,e),r="icons";let l={type:r,provider:i,prefix:e,icons:[]},a=0;return t.forEach((o,u)=>{a+=o.length+1,a>=s&&u>0&&(n.push(l),l={type:r,provider:i,prefix:e,icons:[]},a=o.length),l.icons.push(o)}),n.push(l),n};function _s(i){if(typeof i=="string"){const e=kt(i);if(e)return e.path}return"/"}const ks=(i,e,t)=>{if(!Ut){t("abort",424);return}let n=_s(e.provider);switch(e.type){case"icons":{const r=e.prefix,a=e.icons.join(","),o=new URLSearchParams({icons:a});n+=r+".json?"+o.toString();break}case"custom":{const r=e.uri;n+=r.slice(0,1)==="/"?r.slice(1):r;break}default:t("abort",400);return}let s=503;Ut(i+n).then(r=>{const l=r.status;if(l!==200){setTimeout(()=>{t(vs(l)?"abort":"next",l)});return}return s=501,r.json()}).then(r=>{if(typeof r!="object"||r===null){setTimeout(()=>{r===404?t("abort",r):t("next",s)});return}setTimeout(()=>{t("success",r)})}).catch(()=>{t("next",s)})},Ts={prepare:ys,send:ks};function ws(i){const e={loaded:[],missing:[],pending:[]},t=Object.create(null);i.sort((s,r)=>s.provider!==r.provider?s.provider.localeCompare(r.provider):s.prefix!==r.prefix?s.prefix.localeCompare(r.prefix):s.name.localeCompare(r.name));let n={provider:"",prefix:"",name:""};return i.forEach(s=>{if(n.name===s.name&&n.prefix===s.prefix&&n.provider===s.provider)return;n=s;const r=s.provider,l=s.prefix,a=s.name,o=t[r]||(t[r]=Object.create(null)),u=o[l]||(o[l]=fe(r,l));let p;a in u.icons?p=e.loaded:l===""||u.missing.has(a)?p=e.missing:p=e.pending;const f={provider:r,prefix:l,name:a};p.push(f)}),e}function Bn(i,e){i.forEach(t=>{const n=t.loaderCallbacks;n&&(t.loaderCallbacks=n.filter(s=>s.id!==e))})}function Es(i){i.pendingCallbacksFlag||(i.pendingCallbacksFlag=!0,setTimeout(()=>{i.pendingCallbacksFlag=!1;const e=i.loaderCallbacks?i.loaderCallbacks.slice(0):[];if(!e.length)return;let t=!1;const n=i.provider,s=i.prefix;e.forEach(r=>{const l=r.icons,a=l.pending.length;l.pending=l.pending.filter(o=>{if(o.prefix!==s)return!0;const u=o.name;if(i.icons[u])l.loaded.push({provider:n,prefix:s,name:u});else if(i.missing.has(u))l.missing.push({provider:n,prefix:s,name:u});else return t=!0,!0;return!1}),l.pending.length!==a&&(t||Bn([i],r.id),r.callback(l.loaded.slice(0),l.missing.slice(0),l.pending.slice(0),r.abort))})}))}let Is=0;function Ss(i,e,t){const n=Is++,s=Bn.bind(null,t,n);if(!e.pending.length)return s;const r={id:n,icons:e,callback:i,abort:s};return t.forEach(l=>{(l.loaderCallbacks||(l.loaderCallbacks=[])).push(r)}),s}function As(i,e=!0,t=!1){const n=[];return i.forEach(s=>{const r=typeof s=="string"?Je(s,e,t):s;r&&n.push(r)}),n}var Ps={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function Cs(i,e,t,n){const s=i.resources.length,r=i.random?Math.floor(Math.random()*s):i.index;let l;if(i.random){let w=i.resources.slice(0);for(l=[];w.length>1;){const R=Math.floor(Math.random()*w.length);l.push(w[R]),w=w.slice(0,R).concat(w.slice(R+1))}l=l.concat(w)}else l=i.resources.slice(r).concat(i.resources.slice(0,r));const a=Date.now();let o="pending",u=0,p,f=null,d=[],c=[];typeof n=="function"&&c.push(n);function m(){f&&(clearTimeout(f),f=null)}function y(){o==="pending"&&(o="aborted"),m(),d.forEach(w=>{w.status==="pending"&&(w.status="aborted")}),d=[]}function _(w,R){R&&(c=[]),typeof w=="function"&&c.push(w)}function b(){return{startTime:a,payload:e,status:o,queriesSent:u,queriesPending:d.length,subscribe:_,abort:y}}function g(){o="failed",c.forEach(w=>{w(void 0,p)})}function h(){d.forEach(w=>{w.status==="pending"&&(w.status="aborted")}),d=[]}function k(w,R,N){const z=R!=="success";switch(d=d.filter(S=>S!==w),o){case"pending":break;case"failed":if(z||!i.dataAfterTimeout)return;break;default:return}if(R==="abort"){p=N,g();return}if(z){p=N,d.length||(l.length?L():g());return}if(m(),h(),!i.random){const S=i.resources.indexOf(w.resource);S!==-1&&S!==i.index&&(i.index=S)}o="completed",c.forEach(S=>{S(N)})}function L(){if(o!=="pending")return;m();const w=l.shift();if(w===void 0){if(d.length){f=setTimeout(()=>{m(),o==="pending"&&(h(),g())},i.timeout);return}g();return}const R={status:"pending",resource:w,callback:(N,z)=>{k(R,N,z)}};d.push(R),u++,f=setTimeout(L,i.rotate),t(w,e,R.callback)}return setTimeout(L),b}function Hn(i){const e={...Ps,...i};let t=[];function n(){t=t.filter(a=>a().status==="pending")}function s(a,o,u){const p=Cs(e,a,o,(f,d)=>{n(),u&&u(f,d)});return t.push(p),p}function r(a){return t.find(o=>a(o))||null}return{query:s,find:r,setIndex:a=>{e.index=a},getIndex:()=>e.index,cleanup:n}}function Vt(){}const tt=Object.create(null);function Ns(i){if(!tt[i]){const e=kt(i);if(!e)return;const t=Hn(e),n={config:e,redundancy:t};tt[i]=n}return tt[i]}function Ms(i,e,t){let n,s;if(typeof i=="string"){const r=rt(i);if(!r)return t(void 0,424),Vt;s=r.send;const l=Ns(i);l&&(n=l.redundancy)}else{const r=yt(i);if(r){n=Hn(r);const l=i.resources?i.resources[0]:"",a=rt(l);a&&(s=a.send)}}return!n||!s?(t(void 0,424),Vt):n.query(e,s,t)().abort}const Gt="iconify2",Se="iconify",jn=Se+"-count",qt=Se+"-version",xn=36e5,Os=168;function lt(i,e){try{return i.getItem(e)}catch{}}function Tt(i,e,t){try{return i.setItem(e,t),!0}catch{}}function Wt(i,e){try{i.removeItem(e)}catch{}}function at(i,e){return Tt(i,jn,e.toString())}function ot(i){return parseInt(lt(i,jn))||0}const Xe={local:!0,session:!0},Rn={local:new Set,session:new Set};let wt=!1;function Ds(i){wt=i}let Ne=typeof window>"u"?{}:window;function zn(i){const e=i+"Storage";try{if(Ne&&Ne[e]&&typeof Ne[e].length=="number")return Ne[e]}catch{}Xe[i]=!1}function Un(i,e){const t=zn(i);if(!t)return;const n=lt(t,qt);if(n!==Gt){if(n){const a=ot(t);for(let o=0;o<a;o++)Wt(t,Se+o.toString())}Tt(t,qt,Gt),at(t,0);return}const s=Math.floor(Date.now()/xn)-Os,r=a=>{const o=Se+a.toString(),u=lt(t,o);if(typeof u=="string"){try{const p=JSON.parse(u);if(typeof p=="object"&&typeof p.cached=="number"&&p.cached>s&&typeof p.provider=="string"&&typeof p.data=="object"&&typeof p.data.prefix=="string"&&e(p,a))return!0}catch{}Wt(t,o)}};let l=ot(t);for(let a=l-1;a>=0;a--)r(a)||(a===l-1?(l--,at(t,l)):Rn[i].add(a))}function Vn(){if(!wt){Ds(!0);for(const i in Xe)Un(i,e=>{const t=e.data,n=e.provider,s=t.prefix,r=fe(n,s);if(!vt(r,t).length)return!1;const l=t.lastModified||-1;return r.lastModifiedCached=r.lastModifiedCached?Math.min(r.lastModifiedCached,l):l,!0})}}function Ls(i,e){const t=i.lastModifiedCached;if(t&&t>=e)return t===e;if(i.lastModifiedCached=e,t)for(const n in Xe)Un(n,s=>{const r=s.data;return s.provider!==i.provider||r.prefix!==i.prefix||r.lastModified===e});return!0}function Fs(i,e){wt||Vn();function t(n){let s;if(!Xe[n]||!(s=zn(n)))return;const r=Rn[n];let l;if(r.size)r.delete(l=Array.from(r).shift());else if(l=ot(s),!at(s,l+1))return;const a={cached:Math.floor(Date.now()/xn),provider:i.provider,data:e};return Tt(s,Se+l.toString(),JSON.stringify(a))}e.lastModified&&!Ls(i,e.lastModified)||Object.keys(e.icons).length&&(e.not_found&&(e=Object.assign({},e),delete e.not_found),t("local")||t("session"))}function Kt(){}function Bs(i){i.iconsLoaderFlag||(i.iconsLoaderFlag=!0,setTimeout(()=>{i.iconsLoaderFlag=!1,Es(i)}))}function Hs(i,e){i.iconsToLoad?i.iconsToLoad=i.iconsToLoad.concat(e).sort():i.iconsToLoad=e,i.iconsQueueFlag||(i.iconsQueueFlag=!0,setTimeout(()=>{i.iconsQueueFlag=!1;const{provider:t,prefix:n}=i,s=i.iconsToLoad;delete i.iconsToLoad;let r;if(!s||!(r=rt(t)))return;r.prepare(t,n,s).forEach(a=>{Ms(t,a,o=>{if(typeof o!="object")a.icons.forEach(u=>{i.missing.add(u)});else try{const u=vt(i,o);if(!u.length)return;const p=i.pendingIcons;p&&u.forEach(f=>{p.delete(f)}),Fs(i,o)}catch(u){console.error(u)}Bs(i)})})}))}const js=(i,e)=>{const t=As(i,!0,Dn()),n=ws(t);if(!n.pending.length){let o=!0;return e&&setTimeout(()=>{o&&e(n.loaded,n.missing,n.pending,Kt)}),()=>{o=!1}}const s=Object.create(null),r=[];let l,a;return n.pending.forEach(o=>{const{provider:u,prefix:p}=o;if(p===a&&u===l)return;l=u,a=p,r.push(fe(u,p));const f=s[u]||(s[u]=Object.create(null));f[p]||(f[p]=[])}),n.pending.forEach(o=>{const{provider:u,prefix:p,name:f}=o,d=fe(u,p),c=d.pendingIcons||(d.pendingIcons=new Set);c.has(f)||(c.add(f),s[u][p].push(f))}),r.forEach(o=>{const{provider:u,prefix:p}=o;s[u][p].length&&Hs(o,s[u][p])}),e?Ss(e,n,r):Kt};function xs(i,e){const t={...i};for(const n in e){const s=e[n],r=typeof s;n in Ln?(s===null||s&&(r==="string"||r==="number"))&&(t[n]=s):r===typeof t[n]&&(t[n]=n==="rotate"?s%4:s)}return t}const Rs=/[\s,]+/;function zs(i,e){e.split(Rs).forEach(t=>{switch(t.trim()){case"horizontal":i.hFlip=!0;break;case"vertical":i.vFlip=!0;break}})}function Us(i,e=0){const t=i.replace(/^-?[0-9.]*/,"");function n(s){for(;s<0;)s+=4;return s%4}if(t===""){const s=parseInt(i);return isNaN(s)?0:n(s)}else if(t!==i){let s=0;switch(t){case"%":s=25;break;case"deg":s=90}if(s){let r=parseFloat(i.slice(0,i.length-t.length));return isNaN(r)?0:(r=r/s,r%1===0?n(r):0)}}return e}function Vs(i,e){let t=i.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const n in e)t+=" "+n+'="'+e[n]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+t+">"+i+"</svg>"}function Gs(i){return i.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function qs(i){return"data:image/svg+xml,"+Gs(i)}function Ws(i){return'url("'+qs(i)+'")'}const Jt={...Fn,inline:!1},Ks={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},Js={display:"inline-block"},ut={"background-color":"currentColor"},Gn={"background-color":"transparent"},Yt={image:"var(--svg)",repeat:"no-repeat",size:"100% 100%"},Xt={"-webkit-mask":ut,mask:ut,background:Gn};for(const i in Xt){const e=Xt[i];for(const t in Yt)e[i+"-"+t]=Yt[t]}function Ys(i){return i+(i.match(/^[-0-9.]+$/)?"px":"")}function Xs(i,e){const t=xs(Jt,e),n=e.mode||"svg",s=n==="svg"?{...Ks}:{};i.body.indexOf("xlink:")===-1&&delete s["xmlns:xlink"];let r=typeof e.style=="string"?e.style:"";for(let b in e){const g=e[b];if(g!==void 0)switch(b){case"icon":case"style":case"onLoad":case"mode":break;case"inline":case"hFlip":case"vFlip":t[b]=g===!0||g==="true"||g===1;break;case"flip":typeof g=="string"&&zs(t,g);break;case"color":r=r+(r.length>0&&r.trim().slice(-1)!==";"?";":"")+"color: "+g+"; ";break;case"rotate":typeof g=="string"?t[b]=Us(g):typeof g=="number"&&(t[b]=g);break;case"ariaHidden":case"aria-hidden":g!==!0&&g!=="true"&&delete s["aria-hidden"];break;default:if(b.slice(0,3)==="on:")break;Jt[b]===void 0&&(s[b]=g)}}const l=us(i,t),a=l.attributes;if(t.inline&&(r="vertical-align: -0.125em; "+r),n==="svg"){Object.assign(s,a),r!==""&&(s.style=r);let b=0,g=e.id;return typeof g=="string"&&(g=g.replace(/-/g,"_")),{svg:!0,attributes:s,body:hs(l.body,g?()=>g+"ID"+b++:"iconifySvelte")}}const{body:o,width:u,height:p}=i,f=n==="mask"||(n==="bg"?!1:o.indexOf("currentColor")!==-1),d=Vs(o,{...a,width:u+"",height:p+""}),m={"--svg":Ws(d)},y=b=>{const g=a[b];g&&(m[b]=Ys(g))};y("width"),y("height"),Object.assign(m,Js,f?ut:Gn);let _="";for(const b in m)_+=b+": "+m[b]+";";return s.style=_+r,{svg:!1,attributes:s}}Dn(!0);ms("",Ts);if(typeof document<"u"&&typeof window<"u"){Vn();const i=window;if(i.IconifyPreload!==void 0){const e=i.IconifyPreload,t="Invalid IconifyPreload syntax.";typeof e=="object"&&e!==null&&(e instanceof Array?e:[e]).forEach(n=>{try{(typeof n!="object"||n===null||n instanceof Array||typeof n.icons!="object"||typeof n.prefix!="string"||!rs(n))&&console.error(t)}catch{console.error(t)}})}if(i.IconifyProviders!==void 0){const e=i.IconifyProviders;if(typeof e=="object"&&e!==null)for(let t in e){const n="IconifyProviders["+t+"] is invalid.";try{const s=e[t];if(typeof s!="object"||!s||s.resources===void 0)continue;ps(t,s)||console.error(n)}catch{console.error(n)}}}}function Zs(i,e,t,n,s){function r(){e.loading&&(e.loading.abort(),e.loading=null)}if(typeof i=="object"&&i!==null&&typeof i.body=="string")return e.name="",r(),{data:{...Ye,...i}};let l;if(typeof i!="string"||(l=Je(i,!1,!0))===null)return r(),null;const a=is(l);if(!a)return t&&(!e.loading||e.loading.name!==i)&&(r(),e.name="",e.loading={name:i,abort:js([l],n)}),null;r(),e.name!==i&&(e.name=i,s&&!e.destroyed&&s(i));const o=["iconify"];return l.prefix!==""&&o.push("iconify--"+l.prefix),l.provider!==""&&o.push("iconify--"+l.provider),{data:a,classes:o}}function Qs(i,e){return i?Xs({...Ye,...i},e):null}function Zt(i){let e;function t(r,l){return r[0].svg?er:$s}let n=t(i),s=n(i);return{c(){s.c(),e=Y()},l(r){s.l(r),e=Y()},m(r,l){s.m(r,l),E(r,e,l)},p(r,l){n===(n=t(r))&&s?s.p(r,l):(s.d(1),s=n(r),s&&(s.c(),s.m(e.parentNode,e)))},d(r){s.d(r),r&&v(e)}}}function $s(i){let e,t=[i[0].attributes],n={};for(let s=0;s<t.length;s+=1)n=ae(n,t[s]);return{c(){e=P("span"),this.h()},l(s){e=C(s,"SPAN",{}),M(e).forEach(v),this.h()},h(){ge(e,n)},m(s,r){E(s,e,r)},p(s,r){ge(e,n=qe(t,[r&1&&s[0].attributes]))},d(s){s&&v(e)}}}function er(i){let e,t=i[0].body+"",n=[i[0].attributes],s={};for(let r=0;r<n.length;r+=1)s=ae(s,n[r]);return{c(){e=ai("svg"),this.h()},l(r){e=oi(r,"svg",{});var l=M(e);l.forEach(v),this.h()},h(){St(e,s)},m(r,l){E(r,e,l),e.innerHTML=t},p(r,l){l&1&&t!==(t=r[0].body+"")&&(e.innerHTML=t),St(e,s=qe(n,[l&1&&r[0].attributes]))},d(r){r&&v(e)}}}function tr(i){let e,t=i[0]&&Zt(i);return{c(){t&&t.c(),e=Y()},l(n){t&&t.l(n),e=Y()},m(n,s){t&&t.m(n,s),E(n,e,s)},p(n,[s]){n[0]?t?t.p(n,s):(t=Zt(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:G,o:G,d(n){t&&t.d(n),n&&v(e)}}}function nr(i,e,t){const n={name:"",loading:null,destroyed:!1};let s=!1,r=0,l;const a=u=>{typeof e.onLoad=="function"&&e.onLoad(u),We()("load",{icon:u})};function o(){t(3,r++,r)}return Ke(()=>{t(2,s=!0)}),li(()=>{t(1,n.destroyed=!0,n),n.loading&&(n.loading.abort(),t(1,n.loading=null,n))}),i.$$set=u=>{t(6,e=ae(ae({},e),be(u)))},i.$$.update=()=>{{const u=Zs(e.icon,n,s,o,a);t(0,l=u?Qs(u.data,e):null),l&&u.classes&&t(0,l.attributes.class=(typeof e.class=="string"?e.class+" ":"")+u.classes.join(" "),l)}},e=be(e),[l,n,s,r]}class Qt extends ie{constructor(e){super(),se(this,e,nr,tr,re,{})}}var ir=Object.defineProperty,$t=Object.getOwnPropertySymbols,sr=Object.prototype.hasOwnProperty,rr=Object.prototype.propertyIsEnumerable,en=(i,e,t)=>e in i?ir(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,lr=(i,e)=>{for(var t in e||(e={}))sr.call(e,t)&&en(i,t,e[t]);if($t)for(var t of $t(e))rr.call(e,t)&&en(i,t,e[t]);return i},qn=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},H=(i,e,t)=>(qn(i,e,"read from private field"),t?t.call(i):e.get(i)),le=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},te=(i,e,t,n)=>(qn(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t),ve=(i,e,t)=>new Promise((n,s)=>{var r=o=>{try{a(t.next(o))}catch(u){s(u)}},l=o=>{try{a(t.throw(o))}catch(u){s(u)}},a=o=>o.done?n(o.value):Promise.resolve(o.value).then(r,l);a((t=t.apply(i,e)).next())});function ar(i,e,t){return ve(this,null,function*(){e=e.replace(/#/g,"%23").replace(/([^:]\/)\/+/g,"$1");const n=yield t.fetch(e);if(n.status!==200){console.warn("Error loading buffer. Invalid status: ",n.status,e);return}try{const s=yield n.arrayBuffer();return yield i.decodeAudioData(s)}catch(s){console.warn("Error loading buffer",s,e)}})}function or(i){if(typeof document>"u")return null;const e=document.createElement("audio");for(let t=0;t<i.length;t++){const n=i[t],s=e.canPlayType(`audio/${n}`);if(s==="probably"||s==="maybe")return n;if(n==="m4a"){const r=e.canPlayType("audio/aac");if(r==="probably"||r==="maybe")return n}}return null}var Wn={fetch(i){return fetch(i)}};function Fe(i){const e=i.filter(t=>!!t);return e.reduce((t,n)=>{const s="output"in t?t.output:t,r="input"in n?n.input:n;return s.connect(r),n}),()=>{e.reduce((t,n)=>{const s="output"in t?t.output:t,r="input"in n?n.input:n;return s.disconnect(r),n})}}function ur(i){const t=/^([a-gA-G]?)(#{1,}|b{1,}|)(-?\d+)$/.exec(i);if(!t)return;const n=t[1].toUpperCase();if(!n)return;const s=t[2],r=s[0]==="b"?-s.length:s.length,l=t[3]?+t[3]:4,a=(n.charCodeAt(0)+3)%7;return[0,2,4,5,7,9,11][a]+r+12*(l+1)}function Kn(i){return i===void 0?void 0:typeof i=="number"?i:ur(i)}function ct(i){return i*i/16129}function cr(i,e){let t=0;for(;e[i+t]===void 0&&t<128;)t>0?t=-t:t=-t+1;return t===127?[i,0]:[i+t,-t*100]}function fr(i){let e=i;const t=new Set;function n(l){return t.add(l),l(e),()=>{t.delete(l)}}function s(l){e=l,t.forEach(a=>a(e))}function r(){return e}return{subscribe:n,set:s,get:r}}function dr(){const i=new Set;function e(n){return i.add(n),()=>{i.delete(n)}}function t(n){i.forEach(s=>s(n))}return{subscribe:e,trigger:t}}function hr(i){let e=!1;return()=>{e||(e=!0,i.forEach(t=>t==null?void 0:t()))}}var ce,ue,he,me,Be,ke,mr=class{constructor(i,e){this.context=i,le(this,ce,void 0),le(this,ue,void 0),le(this,he,void 0),le(this,me,void 0),le(this,Be,void 0),le(this,ke,void 0);var t,n;te(this,ke,Object.freeze(lr({destination:i.destination,volume:100,volumeToGain:ct},e))),this.input=new GainNode(this.context),te(this,ce,new GainNode(this.context)),te(this,me,Fe([this.input,H(this,ce),H(this,ke).destination]));const s=fr((t=e.volume)!=null?t:100);this.setVolume=s.set;const r=(n=e.volumeToGain)!=null?n:ct;te(this,Be,s.subscribe(l=>{H(this,ce).gain.value=r(l)}))}addInsert(i){var e;(e=H(this,he))!=null||te(this,he,[]),H(this,he).push(i),H(this,me).call(this),te(this,me,Fe([this.input,...H(this,he),H(this,ce),H(this,ke).destination]))}addEffect(i,e,t){var n;const s=new GainNode(this.context);s.gain.value=t;const r="input"in e?e.input:e,l=Fe([H(this,ce),s,r]);(n=H(this,ue))!=null||te(this,ue,[]),H(this,ue).push({name:i,mix:s,disconnect:l})}sendEffect(i,e){var t;const n=(t=H(this,ue))==null?void 0:t.find(s=>s.name===i);n?n.mix.gain.value=e:console.warn("Send bus not found: "+i)}disconnect(){var i;H(this,me).call(this),H(this,Be).call(this),(i=H(this,ue))==null||i.forEach(e=>e.disconnect()),te(this,ue,void 0)}};ce=new WeakMap;ue=new WeakMap;he=new WeakMap;me=new WeakMap;Be=new WeakMap;ke=new WeakMap;function pr(i){var e,t,n;const s=i.destination.context,r=s.createBufferSource();r.buffer=i.buffer,r.detune.value=(e=i==null?void 0:i.detune)!=null?e:0;const l=i.lpfCutoffHz?new BiquadFilterNode(s,{type:"lowpass",frequency:i.lpfCutoffHz}):void 0,a=s.createGain();a.gain.value=(t=i==null?void 0:i.gain)!=null?t:1;const[o,u]=gr(s,i.decayTime),p=hr([Fe([r,l,a,o,i.destination]),(n=i.stop)==null?void 0:n.call(i,c=>{(c===void 0||c.stopId===void 0||c.stopId===i.stopId)&&d(c==null?void 0:c.time)})]);r.onended=()=>{var c;p(),(c=i.onEnded)==null||c.call(i)};const f=i.time||s.currentTime;r.start(f);function d(c){if(c??(c=s.currentTime),c<=f)r.stop(c);else{const m=u(c);r.stop(m)}}return i.duration!==void 0&&d(f+i.duration),d}function gr(i,e=.2){let t=0;const n=new GainNode(i,{gain:1});function s(r){if(t)return t;n.gain.cancelScheduledValues(r);const l=r||i.currentTime;return t=l+e,n.gain.setValueAtTime(1,l),n.gain.linearRampToValueAtTime(0,t),t}return[n,s]}var ee,Te,He,we,br=class{constructor(i,e={}){this.context=i,le(this,ee,void 0),le(this,Te,void 0),le(this,He,void 0),le(this,we,void 0);var t,n,s,r,l,a,o;te(this,ee,{destination:(t=e.destination)!=null?t:i.destination,detune:0,volume:(n=e.volume)!=null?n:100,velocity:(s=e.velocity)!=null?s:100,buffers:(r=e.buffers)!=null?r:{},volumeToGain:(l=e.volumeToGain)!=null?l:ct,noteToSample:(a=e.noteToSample)!=null?a:f=>[f.note.toString(),0]}),this.buffers={},te(this,Te,dr());const u=(o=e.storage)!=null?o:Wn,p=typeof H(this,ee).buffers=="function"?H(this,ee).buffers:vr(H(this,ee).buffers,u);te(this,He,p(i,this.buffers)),te(this,we,new mr(i,H(this,ee))),this.output=H(this,we)}loaded(){return ve(this,null,function*(){return yield H(this,He),this})}start(i){var e,t,n;const s=typeof i=="object"?i:{note:i},[r,l]=H(this,ee).noteToSample(s,this.buffers,H(this,ee)),a=this.buffers[r];if(!a)return console.warn(`Sample not found: '${r}'`),()=>{};const o=s.onEnded;return pr({buffer:a,destination:H(this,we).input,time:s.time,duration:s.duration,decayTime:s.decayTime,lpfCutoffHz:s.lpfCutoffHz,detune:l+((e=s.detune)!=null?e:H(this,ee).detune),gain:H(this,ee).volumeToGain((t=s.velocity)!=null?t:H(this,ee).velocity),stop:H(this,Te).subscribe,stopId:(n=s.stopId)!=null?n:s.note,onEnded:o?()=>o(i):void 0})}stop(i){const e=typeof i=="object"?i:{stopId:i};H(this,Te).trigger(e)}};ee=new WeakMap;Te=new WeakMap;He=new WeakMap;we=new WeakMap;function vr(i,e){return(t,n)=>ve(this,null,function*(){yield Promise.all([Object.keys(i).map(s=>ve(this,null,function*(){const r=i[s];if(r instanceof AudioBuffer)n[s]=r;else if(typeof r=="string"){const l=yield ar(t,r,e);l&&(n[s]=l)}}))])})}var yr=class extends br{constructor(i,e){var t,n,s,r;const l=e.instrument.startsWith("http")?e.instrument:Er(e.instrument,(t=e.kit)!=null?t:"MusyngKite");super(i,{destination:e.destination,detune:e.detune,volume:e.volume,velocity:e.velocity,decayTime:(n=e.decayTime)!=null?n:.5,lpfCutoffHz:e.lpfCutoffHz,buffers:_r(l,(s=e.storage)!=null?s:Wn),noteToSample:(u,p,f)=>{let d=Kn(u.note);return d===void 0?["",0]:cr(d,p)}});const a=(r=e.extraGain)!=null?r:5,o=new GainNode(i,{gain:a});this.output.addInsert(o)}};function _r(i,e){return(t,n)=>ve(this,null,function*(){const s=yield(yield e.fetch(i)).text(),r=kr(s),l=Object.keys(r);yield Promise.all(l.map(a=>ve(this,null,function*(){const o=Kn(a);if(!o)return;const u=wr(Tr(r[a])),p=yield t.decodeAudioData(u);n[o]=p})))})}function kr(i){const e=i.indexOf("MIDI.Soundfont.");if(e<0)throw Error("Invalid MIDI.js Soundfont format");const t=i.indexOf("=",e)+2,n=i.lastIndexOf(",");return JSON.parse(i.slice(t,n)+"}")}function Tr(i){return i.slice(i.indexOf(",")+1)}function wr(i){const e=window.atob(i),t=e.length,n=new Uint8Array(t);for(let s=0;s<t;s++)n[s]=e.charCodeAt(s);return n.buffer}function Er(i,e){var t;const n=(t=or(["ogg","mp3"]))!=null?t:"mp3";return`https://gleitz.github.io/midi-js-soundfonts/${e}/${i}-${n}.js`}function Ir(i,e,t){let n={};for(let o=1;o<i.length;o++)for(let u of i[o])if(u.name==="Note on"){let p=Math.round(u.tick/t/120*60*1e3);n[p]||(n[p]={tick:u.tick,milliseconds:p,trackIndex:o})}let s=[],r=Object.keys(e);for(let o of r)n[parseInt(o)]||s.push(parseInt(o));let l={},a;r=Object.keys(n);for(let o of s){for(let u=0;u<r.length;u++)parseInt(r[u])<o&&(a=n[r[u]],a.missingEvent=o,a.timerDelta=o-a.milliseconds,a.onNotes=e[o].on,a.offNotes=e[o].off);l[a.milliseconds]=a}return l}function Me(i){let e=Math.floor(i/60),t=Math.floor(i-e*60);return e=e.toString().padStart(2,"0"),t=t.toString().padStart(2,"0"),`${e}:${t}`}function tn(i,e,t){const n=i.slice();return n[21]=e[t],n[22]=e,n[23]=t,n}function Sr(i){let e=Me(i[1])+"",t,n,s,r,l,a,o=Me(i[0])+"",u,p,f,d;function c(h){i[10](h)}function m(h){i[11](h)}let y={step:.5};i[1]!==void 0&&(y.value=i[1]),i[0]!==void 0&&(y.max=i[0]),s=new gi({props:y}),xe.push(()=>Re(s,"value",c)),xe.push(()=>Re(s,"max",m)),s.$on("click",function(){wn(i[6](i[1]))&&i[6](i[1]).apply(this,arguments)});let _=i[3],b=[];for(let h=0;h<_.length;h+=1)b[h]=nn(tn(i,_,h));const g=h=>O(b[h],1,1,()=>{b[h]=null});return{c(){t=j(e),n=F(),q(s.$$.fragment),a=F(),u=j(o),p=F();for(let h=0;h<b.length;h+=1)b[h].c();f=Y()},l(h){t=x(h,e),n=B(h),W(s.$$.fragment,h),a=B(h),u=x(h,o),p=B(h);for(let k=0;k<b.length;k+=1)b[k].l(h);f=Y()},m(h,k){E(h,t,k),E(h,n,k),K(s,h,k),E(h,a,k),E(h,u,k),E(h,p,k);for(let L=0;L<b.length;L+=1)b[L]&&b[L].m(h,k);E(h,f,k),d=!0},p(h,k){i=h,(!d||k&2)&&e!==(e=Me(i[1])+"")&&X(t,e);const L={};if(!r&&k&2&&(r=!0,L.value=i[1],ze(()=>r=!1)),!l&&k&1&&(l=!0,L.max=i[0],ze(()=>l=!1)),s.$set(L),(!d||k&1)&&o!==(o=Me(i[0])+"")&&X(u,o),k&136){_=i[3];let w;for(w=0;w<_.length;w+=1){const R=tn(i,_,w);b[w]?(b[w].p(R,k),A(b[w],1)):(b[w]=nn(R),b[w].c(),A(b[w],1),b[w].m(f.parentNode,f))}for(Q(),w=_.length;w<b.length;w+=1)g(w);$()}},i(h){if(!d){A(s.$$.fragment,h);for(let k=0;k<_.length;k+=1)A(b[k]);d=!0}},o(h){O(s.$$.fragment,h),b=b.filter(Boolean);for(let k=0;k<b.length;k+=1)O(b[k]);d=!1},d(h){h&&v(t),h&&v(n),J(s,h),h&&v(a),h&&v(u),h&&v(p),ye(b,h),h&&v(f)}}}function Ar(i){let e,t;return e=new Sn({}),{c(){q(e.$$.fragment)},l(n){W(e.$$.fragment,n)},m(n,s){K(e,n,s),t=!0},p:G,i(n){t||(A(e.$$.fragment,n),t=!0)},o(n){O(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function nn(i){let e,t,n,s=i[21].name+"",r,l,a,o;function u(f){i[12](f,i[21])}let p={name:i[21].instrumentTrack+"-"+i[21].name};return i[21].playing!==void 0&&(p.checked=i[21].playing),l=new wi({props:p}),xe.push(()=>Re(l,"checked",u)),l.$on("change",i[7]),{c(){e=P("br"),t=F(),n=P("span"),r=j(s),q(l.$$.fragment)},l(f){e=C(f,"BR",{}),t=B(f),n=C(f,"SPAN",{});var d=M(n);r=x(d,s),d.forEach(v),W(l.$$.fragment,f)},m(f,d){E(f,e,d),E(f,t,d),E(f,n,d),I(n,r),K(l,f,d),o=!0},p(f,d){i=f,(!o||d&8)&&s!==(s=i[21].name+"")&&X(r,s);const c={};d&8&&(c.name=i[21].instrumentTrack+"-"+i[21].name),!a&&d&8&&(a=!0,c.checked=i[21].playing,ze(()=>a=!1)),l.$set(c)},i(f){o||(A(l.$$.fragment,f),o=!0)},o(f){O(l.$$.fragment,f),o=!1},d(f){f&&v(e),f&&v(t),f&&v(n),J(l,f)}}}function Pr(i){let e,t,n,s,r,l,a,o,u,p,f,d;t=new Qt({props:{icon:"material-symbols:play-pause"}}),r=new Qt({props:{icon:"material-symbols:stop"}});const c=[Ar,Sr],m=[];function y(_,b){return _[2]?1:0}return o=y(i),u=m[o]=c[o](i),{c(){e=P("button"),q(t.$$.fragment),n=F(),s=P("button"),q(r.$$.fragment),l=F(),a=P("span"),u.c(),this.h()},l(_){e=C(_,"BUTTON",{id:!0});var b=M(e);W(t.$$.fragment,b),b.forEach(v),n=B(_),s=C(_,"BUTTON",{id:!0});var g=M(s);W(r.$$.fragment,g),g.forEach(v),l=B(_),a=C(_,"SPAN",{});var h=M(a);u.l(h),h.forEach(v),this.h()},h(){T(e,"id","playMIDI"),T(s,"id","stopMIDI")},m(_,b){E(_,e,b),K(t,e,null),E(_,n,b),E(_,s,b),K(r,s,null),E(_,l,b),E(_,a,b),m[o].m(a,null),p=!0,f||(d=[U(e,"click",i[4]),U(s,"click",i[5])],f=!0)},p(_,[b]){let g=o;o=y(_),o===g?m[o].p(_,b):(Q(),O(m[g],1,1,()=>{m[g]=null}),$(),u=m[o],u?u.p(_,b):(u=m[o]=c[o](_),u.c()),A(u,1),u.m(a,null))},i(_){p||(A(t.$$.fragment,_),A(r.$$.fragment,_),A(u),p=!0)},o(_){O(t.$$.fragment,_),O(r.$$.fragment,_),O(u),p=!1},d(_){_&&v(e),J(t),_&&v(n),_&&v(s),J(r),_&&v(l),_&&v(a),m[o].d(),f=!1,Ae(d)}}}function Cr(i,e,t){let{midiFile:n=void 0}=e,{timeMap:s=void 0}=e;const r=We();let l,a,o=[],u=0,p=0,f=!1,d=[],c,m=[];const y=function(){l.isPlaying()?(l.pause(),b()):l.play()},_=function(){b(),a.suspend(),l.stop(),t(1,p=0),r("playStopped");for(let N of m)clearTimeout(N)},b=function(){for(let N=0;N<o.length;N++)o[N].stop()},g=function(N){a.resume();for(const S in d)d[S].playing||l.tracks[parseInt(S)+1].disable();let z=Math.round(N.tick/l.division/120*60*1e3);if(c[z]){let S=setTimeout(function(){r("noteOn",c[z].onNotes),r("noteOff",c[z].offNotes)},c[z].timerDelta);m.push(S)}try{N.name==="Note on"&&(r("noteOn",s[z].on),r("noteOff",s[z].off))}catch(S){console.log(S),console.log(z),console.log(s)}N.name=="Note on"&&N.velocity>0?o[N.track-2].start({note:N.noteName,velocity:N.velocity}):N.name=="Note on"&&N.velocity==0&&o[N.track-2].stop()},h=async function(){if(l.isPlaying()){b(),r("skipPlay");for(let N of m)clearTimeout(N);await l.stop(),await l.skipToSeconds(p),y()}else l.skipToSeconds(p)},k=function(){const N=this.name.split("-");d[parseInt(N[0])].playing?l.tracks[parseInt(N[0])+1].enable():(o[parseInt(N[0])].stop(),l.tracks[parseInt(N[0])+1].disable())};Ke(async()=>{l=new Xi.Player(S=>g(S)),l.on("endOfFile",function(){r("playStopped")}),l.loadDataUri(n),t(0,u=l.getSongTime());try{a=new AudioContext}catch(S){console.log(S),a=""}let N=l.getEvents();console.log(l.division);const z={Superius:"violin",Contratenor:"viola",PrimusTenor:"cello",SecundusTenor:"flute",Bassus:"contrabass",default:"acoustic_grand_piano"};for(let S=1;S<N.length;S++){let oe="default";N[S][0].name==="Sequence/Track Name"&&Object.keys(z).includes(N[S][0].string)&&(oe=N[S][0].string);let Ze=await new yr(a,{instrument:z[oe]}).loaded();o.push(Ze),d.push({name:oe,instrumentTrack:S-1,chosenInstrument:z[oe],playing:!0})}setInterval(function(){l.isPlaying()&&t(1,p=u-l.getSongTimeRemaining())},1e3),c=Ir(N,s,l.division),t(2,f=!0)});function L(N){p=N,t(1,p)}function w(N){u=N,t(0,u)}function R(N,z){i.$$.not_equal(z.playing,N)&&(z.playing=N,t(3,d))}return i.$$set=N=>{"midiFile"in N&&t(8,n=N.midiFile),"timeMap"in N&&t(9,s=N.timeMap)},[u,p,f,d,y,_,h,k,n,s,L,w,R]}class Nr extends ie{constructor(e){super(),se(this,e,Cr,Pr,re,{midiFile:8,timeMap:9})}}function sn(i){let e,t,n,s;return{c(){e=P("button"),t=j("<"),this.h()},l(r){e=C(r,"BUTTON",{type:!0,class:!0,"data-testid":!0});var l=M(e);t=x(l,"<"),l.forEach(v),this.h()},h(){T(e,"type","button"),T(e,"class","btn variant-filled"),T(e,"data-testid","btn-prev")},m(r,l){E(r,e,l),I(e,t),n||(s=U(e,"click",i[3]),n=!0)},p:G,d(r){r&&v(e),n=!1,s()}}}function Mr(i){let e=i[0][i[4]]+"",t,n;return{c(){t=j(e),n=j(";")},l(s){t=x(s,e),n=x(s,";")},m(s,r){E(s,t,r),E(s,n,r)},p(s,r){r&17&&e!==(e=s[0][s[4]]+"")&&X(t,e)},d(s){s&&v(t),s&&v(n)}}}function Or(i){let e,t=i[0][i[4]]+"",n;return{c(){e=new En(!1),n=Y(),this.h()},l(s){e=In(s,!1),n=Y(),this.h()},h(){e.a=n},m(s,r){e.m(t,s,r),E(s,n,r)},p(s,r){r&17&&t!==(t=s[0][s[4]]+"")&&e.p(t)},d(s){s&&v(n),s&&e.d()}}}function rn(i){let e,t,n,s;return{c(){e=P("button"),t=j(">"),this.h()},l(r){e=C(r,"BUTTON",{type:!0,class:!0,"data-testid":!0});var l=M(e);t=x(l,">"),l.forEach(v),this.h()},h(){T(e,"type","button"),T(e,"class","btn variant-filled"),T(e,"data-testid","btn-nxt")},m(r,l){E(r,e,l),I(e,t),n||(s=U(e,"click",i[2]),n=!0)},p:G,d(r){r&&v(e),n=!1,s()}}}function Dr(i){let e,t,n,s,r,l,a=i[4]>0&&sn(i);function o(d,c){return d[1]?Or:Mr}let u=o(i),p=u(i),f=i[4]<i[0].length-1&&rn(i);return{c(){e=P("div"),t=P("div"),a&&a.c(),n=F(),s=P("div"),p.c(),r=F(),l=P("div"),f&&f.c(),this.h()},l(d){e=C(d,"DIV",{id:!0,"data-testid":!0,class:!0});var c=M(e);t=C(c,"DIV",{class:!0});var m=M(t);a&&a.l(m),m.forEach(v),n=B(c),s=C(c,"DIV",{id:!0});var y=M(s);p.l(y),y.forEach(v),r=B(c),l=C(c,"DIV",{class:!0});var _=M(l);f&&f.l(_),_.forEach(v),c.forEach(v),this.h()},h(){T(t,"class","left svelte-1mkf375"),T(s,"id","content"),T(l,"class","right svelte-1mkf375"),T(e,"id","page"),T(e,"data-testid","paginator"),T(e,"class","svelte-1mkf375")},m(d,c){E(d,e,c),I(e,t),a&&a.m(t,null),I(e,n),I(e,s),p.m(s,null),I(e,r),I(e,l),f&&f.m(l,null)},p(d,[c]){d[4]>0?a?a.p(d,c):(a=sn(d),a.c(),a.m(t,null)):a&&(a.d(1),a=null),u===(u=o(d))&&p?p.p(d,c):(p.d(1),p=u(d),p&&(p.c(),p.m(s,null))),d[4]<d[0].length-1?f?f.p(d,c):(f=rn(d),f.c(),f.m(l,null)):f&&(f.d(1),f=null)},i:G,o:G,d(d){d&&v(e),a&&a.d(),p.d(),f&&f.d()}}}function Lr(i,e,t){let{data:n=void 0}=e,{raw:s=void 0}=e,r=0;function l(){t(4,r++,r)}function a(){t(4,r--,r)}function o(u){t(4,r=u)}return i.$$set=u=>{"data"in u&&t(0,n=u.data),"raw"in u&&t(1,s=u.raw)},[n,s,l,a,r,o]}class Fr extends ie{constructor(e){super(),se(this,e,Lr,Dr,re,{data:0,raw:1,nextPage:2,prevPage:3,goToPage:5})}get nextPage(){return this.$$.ctx[2]}get prevPage(){return this.$$.ctx[3]}get goToPage(){return this.$$.ctx[5]}}function Br(i){let e,t;return e=new Nr({props:{midiFile:i[1],timeMap:i[2]}}),e.$on("noteOn",i[4]),e.$on("noteOff",i[5]),e.$on("playStopped",i[6]),e.$on("skipPlay",i[6]),{c(){q(e.$$.fragment)},l(n){W(e.$$.fragment,n)},m(n,s){K(e,n,s),t=!0},p(n,s){const r={};s&2&&(r.midiFile=n[1]),s&4&&(r.timeMap=n[2]),e.$set(r)},i(n){t||(A(e.$$.fragment,n),t=!0)},o(n){O(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function Hr(i){let e,t;return{c(){e=P("p"),t=j("Playback is not available"),this.h()},l(n){e=C(n,"P",{class:!0});var s=M(e);t=x(s,"Playback is not available"),s.forEach(v),this.h()},h(){T(e,"class","error")},m(n,s){E(n,e,s),I(e,t)},p:G,i:G,o:G,d(n){n&&v(e)}}}function jr(i){let e,t;return{c(){e=P("p"),t=j("Could not engrave the MEI file."),this.h()},l(n){e=C(n,"P",{class:!0});var s=M(e);t=x(s,"Could not engrave the MEI file."),s.forEach(v),this.h()},h(){T(e,"class","error")},m(n,s){E(n,e,s),I(e,t)},p:G,i:G,o:G,d(n){n&&v(e)}}}function xr(i){let e,t=i[0][0]+"",n;return{c(){e=new En(!1),n=Y(),this.h()},l(s){e=In(s,!1),n=Y(),this.h()},h(){e.a=n},m(s,r){e.m(t,s,r),E(s,n,r)},p(s,r){r&1&&t!==(t=s[0][0]+"")&&e.p(t)},i:G,o:G,d(s){s&&v(n),s&&e.d()}}}function Rr(i){let e,t,n;function s(l){i[7](l)}let r={data:i[0],raw:"true"};return i[3]!==void 0&&(r.goToPage=i[3]),e=new Fr({props:r}),xe.push(()=>Re(e,"goToPage",s)),{c(){q(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,a){K(e,l,a),n=!0},p(l,a){const o={};a&1&&(o.data=l[0]),!t&&a&8&&(t=!0,o.goToPage=l[3],ze(()=>t=!1)),e.$set(o)},i(l){n||(A(e.$$.fragment,l),n=!0)},o(l){O(e.$$.fragment,l),n=!1},d(l){J(e,l)}}}function zr(i){let e,t,n,s,r,l,a;const o=[Hr,Br],u=[];function p(m,y){return!m[1]||!m[2]?0:1}e=p(i),t=u[e]=o[e](i);const f=[Rr,xr,jr],d=[];function c(m,y){return m[0].length>1?0:m[0].length===1?1:m[0].length===0||!m[0]?2:-1}return~(r=c(i))&&(l=d[r]=f[r](i)),{c(){t.c(),n=F(),s=P("div"),l&&l.c(),this.h()},l(m){t.l(m),n=B(m),s=C(m,"DIV",{id:!0});var y=M(s);l&&l.l(y),y.forEach(v),this.h()},h(){T(s,"id","MEI-container")},m(m,y){u[e].m(m,y),E(m,n,y),E(m,s,y),~r&&d[r].m(s,null),a=!0},p(m,[y]){let _=e;e=p(m),e===_?u[e].p(m,y):(Q(),O(u[_],1,1,()=>{u[_]=null}),$(),t=u[e],t?t.p(m,y):(t=u[e]=o[e](m),t.c()),A(t,1),t.m(n.parentNode,n));let b=r;r=c(m),r===b?~r&&d[r].p(m,y):(l&&(Q(),O(d[b],1,1,()=>{d[b]=null}),$()),~r?(l=d[r],l?l.p(m,y):(l=d[r]=f[r](m),l.c()),A(l,1),l.m(s,null)):l=null)},i(m){a||(A(t),A(l),a=!0)},o(m){O(t),O(l),a=!1},d(m){u[e].d(m),m&&v(n),m&&v(s),~r&&d[r].d()}}}function Ur(i,e,t){let{meiSvg:n=void 0}=e,{meiMidi:s=void 0}=e,{timeMap:r=void 0}=e,l;const a=function(f){for(let d in f.detail){let c=document.getElementById(f.detail[d]);if(!c)for(let m in n)n[m].includes(`id="${f.detail[d]}"`)&&l(m);c&&c.classList.add("note-playing")}},o=function(f){for(let d in f.detail){let c=document.getElementById(f.detail[d]);c&&c.classList.remove("note-playing")}},u=function(f){const d=document.getElementsByClassName("note-playing");let c=[];for(let m of d)c.push(m.id);for(let m of c)document.getElementById(m).classList.remove("note-playing")};function p(f){l=f,t(3,l)}return i.$$set=f=>{"meiSvg"in f&&t(0,n=f.meiSvg),"meiMidi"in f&&t(1,s=f.meiMidi),"timeMap"in f&&t(2,r=f.timeMap)},[n,s,r,l,a,o,u,p]}class Vr extends ie{constructor(e){super(),se(this,e,Ur,zr,re,{meiSvg:0,meiMidi:1,timeMap:2})}}const ln=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],an=["January","February","March","April","May","June","July","August","September","October","November","December"];function Ge(i){return i[0].toUpperCase()+i.slice(1)}function de(i){return i=i.filter(e=>e),[...new Set(i)]}function on(i,e,t){const n=i.slice();return n[8]=e[t],n}function un(i){let e,t=i[8]+"",n,s,r,l;return{c(){e=P("button"),n=j(t),this.h()},l(a){e=C(a,"BUTTON",{class:!0});var o=M(e);n=x(o,t),o.forEach(v),this.h()},h(){T(e,"class",s="chip "+(i[2].includes(i[8])?"variant-filled":"variant-soft"))},m(a,o){E(a,e,o),I(e,n),r||(l=[U(e,"click",function(){wn(i[3](i[8]))&&i[3](i[8]).apply(this,arguments)}),U(e,"keypress",i[6])],r=!0)},p(a,o){i=a,o&1&&t!==(t=i[8]+"")&&X(n,t),o&5&&s!==(s="chip "+(i[2].includes(i[8])?"variant-filled":"variant-soft"))&&T(e,"class",s)},d(a){a&&v(e),r=!1,Ae(l)}}}function Gr(i){let e,t,n,s,r,l,a,o,u,p,f=i[0].sort(),d=[];for(let c=0;c<f.length;c+=1)d[c]=un(on(i,f,c));return{c(){e=P("div"),t=P("h4"),n=j(i[1]),s=F();for(let c=0;c<d.length;c+=1)d[c].c();r=F(),l=P("button"),a=j("Reset"),this.h()},l(c){e=C(c,"DIV",{class:!0});var m=M(e);t=C(m,"H4",{class:!0});var y=M(t);n=x(y,i[1]),y.forEach(v),s=B(m);for(let b=0;b<d.length;b+=1)d[b].l(m);r=B(m),l=C(m,"BUTTON",{id:!0,class:!0});var _=M(l);a=x(_,"Reset"),_.forEach(v),m.forEach(v),this.h()},h(){T(t,"class","svelte-1i04fdk"),T(l,"id",o=i[1]+"-reset"),T(l,"class","chip variant-filled-surface"),l.disabled=!0,T(e,"class","tag-selector-container svelte-1i04fdk")},m(c,m){E(c,e,m),I(e,t),I(t,n),I(e,s);for(let y=0;y<d.length;y+=1)d[y]&&d[y].m(e,null);I(e,r),I(e,l),I(l,a),u||(p=[U(l,"click",i[4]),U(l,"keypress",i[5])],u=!0)},p(c,[m]){if(m&2&&X(n,c[1]),m&13){f=c[0].sort();let y;for(y=0;y<f.length;y+=1){const _=on(c,f,y);d[y]?d[y].p(_,m):(d[y]=un(_),d[y].c(),d[y].m(e,r))}for(;y<d.length;y+=1)d[y].d(1);d.length=f.length}m&2&&o!==(o=c[1]+"-reset")&&T(l,"id",o)},i:G,o:G,d(c){c&&v(e),ye(d,c),u=!1,Ae(p)}}}function qr(i,e,t){const n=We();let{listTags:s}=e,{filter:r}=e,l=[];function a(f){l.includes(f)?t(2,l=l.filter(c=>c!=f)):t(2,l=[...l,f]);const d=document.getElementById(`${r}-reset`);l.length>0?d.disabled=!1:d.disabled=!0}function o(){t(2,l=[])}function u(f){Z.call(this,i,f)}function p(f){Z.call(this,i,f)}return i.$$set=f=>{"listTags"in f&&t(0,s=f.listTags),"filter"in f&&t(1,r=f.filter)},i.$$.update=()=>{i.$$.dirty&6&&n("filter-changed",{filter:r,selected:l})},[s,r,l,a,o,u,p]}class cn extends ie{constructor(e){super(),se(this,e,qr,Gr,re,{listTags:0,filter:1})}}function fn(i,e,t){const n=i.slice();return n[10]=e[t],n}function dn(i,e,t){const n=i.slice();return n[13]=e[t],n}function hn(i){let e,t=ln[i[10].date.getDay()]+"",n,s,r=i[10].date.getDate()+"",l,a,o=an[i[10].date.getMonth()]+"",u,p,f=i[10].date.getFullYear()+"",d;return{c(){e=P("p"),n=j(t),s=j(", "),l=j(r),a=j(" of "),u=j(o),p=F(),d=j(f),this.h()},l(c){e=C(c,"P",{class:!0});var m=M(e);n=x(m,t),s=x(m,", "),l=x(m,r),a=x(m," of "),u=x(m,o),p=B(m),d=x(m,f),m.forEach(v),this.h()},h(){T(e,"class","date svelte-xt8c9")},m(c,m){E(c,e,m),I(e,n),I(e,s),I(e,l),I(e,a),I(e,u),I(e,p),I(e,d)},p(c,m){m&4&&t!==(t=ln[c[10].date.getDay()]+"")&&X(n,t),m&4&&r!==(r=c[10].date.getDate()+"")&&X(l,r),m&4&&o!==(o=an[c[10].date.getMonth()]+"")&&X(u,o),m&4&&f!==(f=c[10].date.getFullYear()+"")&&X(d,f)},d(c){c&&v(e)}}}function mn(i){let e,t,n=Ge(i[10].author)+"",s;return{c(){e=P("p"),t=j("by "),s=j(n),this.h()},l(r){e=C(r,"P",{class:!0});var l=M(e);t=x(l,"by "),s=x(l,n),l.forEach(v),this.h()},h(){T(e,"class","byline svelte-xt8c9")},m(r,l){E(r,e,l),I(e,t),I(e,s)},p(r,l){l&4&&n!==(n=Ge(r[10].author)+"")&&X(s,n)},d(r){r&&v(e)}}}function pn(i){let e,t=i[10].tags,n=[];for(let s=0;s<t.length;s+=1)n[s]=gn(dn(i,t,s));return{c(){e=P("div");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){e=C(s,"DIV",{class:!0});var r=M(e);for(let l=0;l<n.length;l+=1)n[l].l(r);r.forEach(v),this.h()},h(){T(e,"class","tags svelte-xt8c9")},m(s,r){E(s,e,r);for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(e,null)},p(s,r){if(r&4){t=s[10].tags;let l;for(l=0;l<t.length;l+=1){const a=dn(s,t,l);n[l]?n[l].p(a,r):(n[l]=gn(a),n[l].c(),n[l].m(e,null))}for(;l<n.length;l+=1)n[l].d(1);n.length=t.length}},d(s){s&&v(e),ye(n,s)}}}function gn(i){let e,t=Ge(i[13])+"",n;return{c(){e=P("span"),n=j(t),this.h()},l(s){e=C(s,"SPAN",{class:!0});var r=M(e);n=x(r,t),r.forEach(v),this.h()},h(){T(e,"class","chip variant-ghost svelte-xt8c9")},m(s,r){E(s,e,r),I(e,n)},p(s,r){r&4&&t!==(t=Ge(s[13])+"")&&X(n,t)},d(s){s&&v(e)}}}function bn(i){let e,t,n,s,r,l,a,o,u,p,f=i[10].date&&hn(i);r=new An({props:{content:i[10].content}});let d=i[10].author&&mn(i),c=i[10].tags&&pn(i);return{c(){e=P("div"),t=P("header"),f&&f.c(),n=F(),s=P("section"),q(r.$$.fragment),l=F(),a=P("footer"),d&&d.c(),o=F(),c&&c.c(),u=F(),this.h()},l(m){e=C(m,"DIV",{class:!0});var y=M(e);t=C(y,"HEADER",{class:!0});var _=M(t);f&&f.l(_),_.forEach(v),n=B(y),s=C(y,"SECTION",{class:!0});var b=M(s);W(r.$$.fragment,b),b.forEach(v),l=B(y),a=C(y,"FOOTER",{class:!0});var g=M(a);d&&d.l(g),o=B(g),c&&c.l(g),g.forEach(v),u=B(y),y.forEach(v),this.h()},h(){T(t,"class","card-header"),T(s,"class","p-4"),T(a,"class","card-footer"),T(e,"class","card svelte-xt8c9")},m(m,y){E(m,e,y),I(e,t),f&&f.m(t,null),I(e,n),I(e,s),K(r,s,null),I(e,l),I(e,a),d&&d.m(a,null),I(a,o),c&&c.m(a,null),I(e,u),p=!0},p(m,y){m[10].date?f?f.p(m,y):(f=hn(m),f.c(),f.m(t,null)):f&&(f.d(1),f=null);const _={};y&4&&(_.content=m[10].content),r.$set(_),m[10].author?d?d.p(m,y):(d=mn(m),d.c(),d.m(a,o)):d&&(d.d(1),d=null),m[10].tags?c?c.p(m,y):(c=pn(m),c.c(),c.m(a,null)):c&&(c.d(1),c=null)},i(m){p||(A(r.$$.fragment,m),p=!0)},o(m){O(r.$$.fragment,m),p=!1},d(m){m&&v(e),f&&f.d(),J(r),d&&d.d(),c&&c.d()}}}function Wr(i){let e,t,n,s,r,l,a;t=new cn({props:{listTags:i[0],filter:"authors"}}),t.$on("filter-changed",i[3]),s=new cn({props:{listTags:i[1],filter:"tags"}}),s.$on("filter-changed",i[3]);let o=i[2],u=[];for(let f=0;f<o.length;f+=1)u[f]=bn(fn(i,o,f));const p=f=>O(u[f],1,1,()=>{u[f]=null});return{c(){e=P("div"),q(t.$$.fragment),n=F(),q(s.$$.fragment),r=F(),l=P("div");for(let f=0;f<u.length;f+=1)u[f].c();this.h()},l(f){e=C(f,"DIV",{class:!0});var d=M(e);W(t.$$.fragment,d),n=B(d),W(s.$$.fragment,d),d.forEach(v),r=B(f),l=C(f,"DIV",{class:!0});var c=M(l);for(let m=0;m<u.length;m+=1)u[m].l(c);c.forEach(v),this.h()},h(){T(e,"class","filters svelte-xt8c9"),T(l,"class","card-collection svelte-xt8c9")},m(f,d){E(f,e,d),K(t,e,null),I(e,n),K(s,e,null),E(f,r,d),E(f,l,d);for(let c=0;c<u.length;c+=1)u[c]&&u[c].m(l,null);a=!0},p(f,[d]){const c={};d&1&&(c.listTags=f[0]),t.$set(c);const m={};if(d&2&&(m.listTags=f[1]),s.$set(m),d&4){o=f[2];let y;for(y=0;y<o.length;y+=1){const _=fn(f,o,y);u[y]?(u[y].p(_,d),A(u[y],1)):(u[y]=bn(_),u[y].c(),A(u[y],1),u[y].m(l,null))}for(Q(),y=o.length;y<u.length;y+=1)p(y);$()}},i(f){if(!a){A(t.$$.fragment,f),A(s.$$.fragment,f);for(let d=0;d<o.length;d+=1)A(u[d]);a=!0}},o(f){O(t.$$.fragment,f),O(s.$$.fragment,f),u=u.filter(Boolean);for(let d=0;d<u.length;d+=1)O(u[d]);a=!1},d(f){f&&v(e),J(t),J(s),f&&v(r),f&&v(l),ye(u,f)}}}function Kr(i){let e=i.length,t;for(;e!=0;)t=Math.floor(Math.random()*e),e--,[i[e],i[t]]=[i[t],i[e]];return i}function Jr(i,e,t){let{buzzwords:n}=e,{listTags:s}=e,{listAuthors:r}=e,l=[],a=[],o=[],u=[],p=[];function f(c){c.detail.filter==="authors"?t(7,o=c.detail.selected):c.detail.filter==="tags"&&t(8,u=c.detail.selected),t(2,p=d(p,o,u))}function d(c,m,y){if(m.length===0&&y.length===0)return n;(m.length===0||y.length===0)&&(c=n);let _=c.filter(function(h){if(h.author){if(m.length>0&&m.includes(h.author))return h.author;if(m.length===0)return h.author}}),b=[];for(let h of c)h.tags&&y.every(k=>h.tags.includes(k))&&b.push(h);let g=[];return _.length<c.length&&b.length<c.length?g=_.filter(h=>b.includes(h)):_.length<c.length?g=_:b.length<c.length?g=b:_.length===c.length&&b.length===c.length&&(g=c),g}return Ke(()=>{t(4,n=Kr(n)),t(2,p=n),t(0,l=r),t(1,a=s)}),i.$$set=c=>{"buzzwords"in c&&t(4,n=c.buzzwords),"listTags"in c&&t(5,s=c.listTags),"listAuthors"in c&&t(6,r=c.listAuthors)},i.$$.update=()=>{i.$$.dirty&487&&(u.length===0&&o.length>=1?t(1,a=de(p.map(c=>c.tags).flat())):o.length===0&&u.length>=1?t(0,l=de(p.map(c=>c.author))):o.length>=1?t(1,a=de(p.map(c=>c.tags).flat())):u.length>=1?t(0,l=de(p.map(c=>c.author))):(t(0,l=r),t(1,a=s)),t(0,l=de([...l,...o])),t(1,a=de([...a,...u])))},[l,a,p,f,n,s,r,o,u]}class Yr extends ie{constructor(e){super(),se(this,e,Jr,Wr,re,{buzzwords:4,listTags:5,listAuthors:6})}}function vn(i,e,t){const n=i.slice();return n[1]=e[t][0],n[2]=e[t][1],n}function yn(i){let e,t=i[1]+"",n,s,r,l;return r=new An({props:{content:i[2].content}}),{c(){e=P("h2"),n=j(t),s=F(),q(r.$$.fragment)},l(a){e=C(a,"H2",{});var o=M(e);n=x(o,t),o.forEach(v),s=B(a),W(r.$$.fragment,a)},m(a,o){E(a,e,o),I(e,n),E(a,s,o),K(r,a,o),l=!0},p(a,o){(!l||o&1)&&t!==(t=a[1]+"")&&X(n,t);const u={};o&1&&(u.content=a[2].content),r.$set(u)},i(a){l||(A(r.$$.fragment,a),l=!0)},o(a){O(r.$$.fragment,a),l=!1},d(a){a&&v(e),a&&v(s),J(r,a)}}}function _n(i){let e,t,n=i[2].type==="md"&&yn(i);return{c(){n&&n.c(),e=Y()},l(s){n&&n.l(s),e=Y()},m(s,r){n&&n.m(s,r),E(s,e,r),t=!0},p(s,r){s[2].type==="md"?n?(n.p(s,r),r&1&&A(n,1)):(n=yn(s),n.c(),A(n,1),n.m(e.parentNode,e)):n&&(Q(),O(n,1,1,()=>{n=null}),$())},i(s){t||(A(n),t=!0)},o(s){O(n),t=!1},d(s){n&&n.d(s),s&&v(e)}}}function Xr(i){let e,t,n,s,r;return s=new Yr({props:{buzzwords:i[0].view.buzzwords,listTags:i[0].view.buzzwordTags,listAuthors:i[0].view.buzzwordAuthors}}),{c(){e=P("h3"),t=j("Buzzwords"),n=F(),q(s.$$.fragment)},l(l){e=C(l,"H3",{});var a=M(e);t=x(a,"Buzzwords"),a.forEach(v),n=B(l),W(s.$$.fragment,l)},m(l,a){E(l,e,a),I(e,t),E(l,n,a),K(s,l,a),r=!0},p(l,a){const o={};a&1&&(o.buzzwords=l[0].view.buzzwords),a&1&&(o.listTags=l[0].view.buzzwordTags),a&1&&(o.listAuthors=l[0].view.buzzwordAuthors),s.$set(o)},i(l){r||(A(s.$$.fragment,l),r=!0)},o(l){O(s.$$.fragment,l),r=!1},d(l){l&&v(e),l&&v(n),J(s,l)}}}function Zr(i){let e,t,n,s,r,l,a,o,u,p;s=new qi({props:{audioPath:pt+"/content/music/media/virtualbarbershop.mp3"}});let f="mei"in i[0].view&&kn(i);return{c(){e=P("h3"),t=j("Binaural recording test"),n=F(),q(s.$$.fragment),r=F(),l=P("h3"),a=j("MEI engraving and playback test"),o=F(),f&&f.c(),u=Y()},l(d){e=C(d,"H3",{});var c=M(e);t=x(c,"Binaural recording test"),c.forEach(v),n=B(d),W(s.$$.fragment,d),r=B(d),l=C(d,"H3",{});var m=M(l);a=x(m,"MEI engraving and playback test"),m.forEach(v),o=B(d),f&&f.l(d),u=Y()},m(d,c){E(d,e,c),I(e,t),E(d,n,c),K(s,d,c),E(d,r,c),E(d,l,c),I(l,a),E(d,o,c),f&&f.m(d,c),E(d,u,c),p=!0},p(d,c){"mei"in d[0].view?f?(f.p(d,c),c&1&&A(f,1)):(f=kn(d),f.c(),A(f,1),f.m(u.parentNode,u)):f&&(Q(),O(f,1,1,()=>{f=null}),$())},i(d){p||(A(s.$$.fragment,d),A(f),p=!0)},o(d){O(s.$$.fragment,d),O(f),p=!1},d(d){d&&v(e),d&&v(n),J(s,d),d&&v(r),d&&v(l),d&&v(o),f&&f.d(d),d&&v(u)}}}function Qr(i){let e,t,n,s,r;return s=new Ui({props:{path:pt+"/content/literature/data/Coopers_hill_1655.xml"}}),{c(){e=P("h3"),t=j("Test"),n=F(),q(s.$$.fragment)},l(l){e=C(l,"H3",{});var a=M(e);t=x(a,"Test"),a.forEach(v),n=B(l),W(s.$$.fragment,l)},m(l,a){E(l,e,a),I(e,t),E(l,n,a),K(s,l,a),r=!0},p:G,i(l){r||(A(s.$$.fragment,l),r=!0)},o(l){O(s.$$.fragment,l),r=!1},d(l){l&&v(e),l&&v(n),J(s,l)}}}function kn(i){let e,t;return e=new Vr({props:{meiSvg:i[0].view.mei.svg,meiMidi:i[0].view.mei.midi,timeMap:i[0].view.mei.timeMap}}),{c(){q(e.$$.fragment)},l(n){W(e.$$.fragment,n)},m(n,s){K(e,n,s),t=!0},p(n,s){const r={};s&1&&(r.meiSvg=n[0].view.mei.svg),s&1&&(r.meiMidi=n[0].view.mei.midi),s&1&&(r.timeMap=n[0].view.mei.timeMap),e.$set(r)},i(n){t||(A(e.$$.fragment,n),t=!0)},o(n){O(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function $r(i){let e,t,n,s,r=i[0].view.title+"",l,a,o,u,p,f,d,c=Object.entries(i[0].view.sections),m=[];for(let h=0;h<c.length;h+=1)m[h]=_n(vn(i,c,h));const y=h=>O(m[h],1,1,()=>{m[h]=null}),_=[Qr,Zr,Xr],b=[];function g(h,k){return h[0].view.slug==="literature"?0:h[0].view.slug==="music"?1:h[0].view.slug==="connections"?2:-1}return~(u=g(i))&&(p=b[u]=_[u](i)),{c(){e=P("h1"),t=j("View page"),n=F(),s=P("h1"),l=j(r),a=F();for(let h=0;h<m.length;h+=1)m[h].c();o=F(),p&&p.c(),f=Y()},l(h){e=C(h,"H1",{});var k=M(e);t=x(k,"View page"),k.forEach(v),n=B(h),s=C(h,"H1",{});var L=M(s);l=x(L,r),L.forEach(v),a=B(h);for(let w=0;w<m.length;w+=1)m[w].l(h);o=B(h),p&&p.l(h),f=Y()},m(h,k){E(h,e,k),I(e,t),E(h,n,k),E(h,s,k),I(s,l),E(h,a,k);for(let L=0;L<m.length;L+=1)m[L]&&m[L].m(h,k);E(h,o,k),~u&&b[u].m(h,k),E(h,f,k),d=!0},p(h,[k]){if((!d||k&1)&&r!==(r=h[0].view.title+"")&&X(l,r),k&1){c=Object.entries(h[0].view.sections);let w;for(w=0;w<c.length;w+=1){const R=vn(h,c,w);m[w]?(m[w].p(R,k),A(m[w],1)):(m[w]=_n(R),m[w].c(),A(m[w],1),m[w].m(o.parentNode,o))}for(Q(),w=c.length;w<m.length;w+=1)y(w);$()}let L=u;u=g(h),u===L?~u&&b[u].p(h,k):(p&&(Q(),O(b[L],1,1,()=>{b[L]=null}),$()),~u?(p=b[u],p?p.p(h,k):(p=b[u]=_[u](h),p.c()),A(p,1),p.m(f.parentNode,f)):p=null)},i(h){if(!d){for(let k=0;k<c.length;k+=1)A(m[k]);A(p),d=!0}},o(h){m=m.filter(Boolean);for(let k=0;k<m.length;k+=1)O(m[k]);O(p),d=!1},d(h){h&&v(e),h&&v(n),h&&v(s),h&&v(a),ye(m,h),h&&v(o),~u&&b[u].d(h),h&&v(f)}}}function el(i,e,t){let{data:n}=e;return i.$$set=s=>{"data"in s&&t(0,n=s.data)},[n]}class rl extends ie{constructor(e){super(),se(this,e,el,$r,re,{data:0})}}export{rl as component};
